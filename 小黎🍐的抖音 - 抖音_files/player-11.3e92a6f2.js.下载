/*! For license information please see player-11.3e92a6f2.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={})}(this,function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function r(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var n=/[^a-zA-Z0-9\\_:.-]/gim,i=/</g,o=/>/g,a=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,u=/&colon;?/gim,c=/&newline;?/gim,l=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,h=/u\s*r\s*l\s*\(.*/gi,d=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,f=/"/g,v=function(e){return e.replace(i,"&lt;").replace(o,"&gt;")},p={indexOf:function(e,t){var r,n;for(r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return -1},forEach:function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e)},some:function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)if(t.call(r,e[n],n,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},includes:function(e,t){if("string"==typeof e)return -1!==e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},r=[],n=0;n<e.length;n++)t[e[n]]||(r.push(e[n]),t[e[n]]=!0);return r},from:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},keys:function(e){var t=[];for(var r in e)t.push(r);return t}};function g(e){return null==e}function _(e){var t;return'"'===(t=e)[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]?e.substr(1,e.length-2):e}function m(e){var t,r,n,i,o,a,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",l=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?t+=String.fromCharCode(n>>6|192)+String.fromCharCode(63&n|128):t+=String.fromCharCode(n>>12|224)+String.fromCharCode(n>>6&63|128)+String.fromCharCode(63&n|128)}return t}(e);l<e.length;)i=(t=e.charCodeAt(l++))>>2,o=(3&t)<<4|(r=e.charCodeAt(l++))>>4,a=(15&r)<<2|(n=e.charCodeAt(l++))>>6,s=63&n,isNaN(r)?a=s=64:isNaN(n)&&(s=64),c=c+u.charAt(i)+u.charAt(o)+u.charAt(a)+u.charAt(s);return c}function y(e){var t,r,n,i,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(i=s.indexOf(e.charAt(c++)))>>4,r=(15&i)<<4|(o=s.indexOf(e.charAt(c++)))>>2,n=(3&o)<<6|(a=s.indexOf(e.charAt(c++))),u+=String.fromCharCode(t),64!==o&&(u+=String.fromCharCode(r)),64!==a&&(u+=String.fromCharCode(n));return function(e){for(var t="",r=0,n=0,i=0,o=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(t+=String.fromCharCode((31&n)<<6|63&(o=e.charCodeAt(r+1))),r+=2):(o=e.charCodeAt(r+1),t+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&(i=e.charCodeAt(r+2))),r+=3);return t}(u)}function b(e,t,r){var n="",i=0,o=!1,a=!1,s=0,u=e.length,c="",l="";e:for(s=0;s<u;s++){var h=e.charAt(s);if(!1===o){if("<"===h){o=s;continue}}else if(!1===a){if("<"===h){n+=r(e.slice(i,s)),o=s,i=s;continue}if(">"===h||s===u-1){n+=r(e.slice(i,o)),c=function(e){var t,r=p.spaceIndex(e);return t=-1===r?e.slice(1,-1):e.slice(1,r+1),"/"===(t=p.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}(l=e.slice(o,s+1)),n+=t(o,n.length,c,l,"</"===l.slice(0,2)),i=s+1,o=!1;continue}if('"'===h||"'"===h)for(var d=1,f=e.charAt(s-d);""===f.trim()||"="===f;){if("="===f){a=h;continue e}f=e.charAt(s-++d)}}else if(h===a){a=!1;continue}}return i<u&&(n+=r(e.substr(i))),n}function k(e,t){var r=0,i=0,o=[],a=!1,s=e.length;function u(e,r){if(!((e=(e=p.trim(e)).replace(n,"").toLowerCase()).length<1)){var i=t(e,r||"");i&&o.push(i)}}for(var c=0;c<s;c++){var l=e.charAt(c),h=void 0;if(!1!==a||"="!==l){if(!1===a||c!==i){if(/\s|\n|\t/.test(l)){if(e=e.replace(/\s|\n|\t/g," "),!1===a){if(-1===(h=function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"="===r?t:-1}return -1}(e,c))){u(p.trim(e.slice(r,c))),a=!1,r=c+1;continue}c=h-1;continue}if(-1===(h=function(e,t){for(;t>0;t--){var r=e[t];if(" "!==r)return"="===r?t:-1}return -1}(e,c-1))){u(a,_(p.trim(e.slice(r,c)))),a=!1,r=c+1;continue}}}else{if(-1===(h=e.indexOf(l,c+1)))break;u(a,p.trim(e.slice(i+1,h))),a=!1,r=(c=h)+1}}else a=e.slice(r,c),r=c+1,i='"'===e.charAt(r)||"'"===e.charAt(r)?r:function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"'"===r||'"'===r?t:-1}return -1}(e,c+1)}return r<e.length&&(!1===a?u(e.slice(r)):u(a,_(p.trim(e.slice(r))))),p.trim(o.join(" "))}function E(e,t,r){if(r=function(e){return e=function(e){for(var t="",r=0,n=e.length;r<n;r++)t+=32>e.charCodeAt(r)?" ":e.charAt(r);return p.trim(t)}(e=(e=(e=e.replace(s,'"')).replace(a,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})).replace(u,":").replace(c," "))}(r),"href"===t||"src"===t){if("#"===(r=p.trim(r)))return"#";if("http://"!==r.substr(0,7)&&"https://"!==r.substr(0,8)&&"mailto:"!==r.substr(0,7)&&"tel:"!==r.substr(0,4)&&"data:image/"!==r.substr(0,11)&&"ftp://"!==r.substr(0,6)&&"./"!==r.substr(0,2)&&"../"!==r.substr(0,3)&&"#"!==r[0]&&"/"!==r[0])return""}else if("background"===t){if(l.lastIndex=0,l.test(r))return""}else if("style"===t&&(d.lastIndex=0,d.test(r)||(h.lastIndex=0,h.test(r)&&(l.lastIndex=0,l.test(r)))))return"";return r=function(e){return e=v(e=e.replace(f,"&quot;"))}(r)}var C=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},w=function(){function e(e){var t=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag,t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=E,t.escapeHtml=v,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t,r,n,i,o,a,s=this.options,u=s.whiteList,c=s.onTag,l=s.onIgnoreTag,h=s.onTagAttr,d=s.onIgnoreTagAttr,f=s.safeAttrValue,v=s.escapeHtml;s.stripBlankChar&&(e=(t=(t=e.split("")).filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)})).join("")),s.allowCommentTag||(e=function(e){for(var t="",r=0;r<e.length;){var n=e.indexOf("\x3c!--",r);if(-1===n){t+=e.slice(r);break}t+=e.slice(r,n);var i=e.indexOf("--\x3e",n);if(-1===i)break;r=i+3}return t}(e));var g=!1;s.stripIgnoreTagBody&&(r=s.stripIgnoreTagBody,"function"!=typeof(n=l)&&(n=function(){}),i=!Array.isArray(r),o=[],a=!1,l=(g={onIgnoreTag:function(e,t,s){var u;if(u=e,i||-1!==p.indexOf(r,u)){if(s.isClosing){var c="[/removed]",l=s.position+c.length;return o.push([!1!==a?a:s.position,l]),a=!1,c}return a||(a=s.position),"[removed]"}return n(e,t,s)},remove:function(e){var t="",r=0;return p.forEach(o,function(n){t+=e.slice(r,n[0]),r=n[1]}),t+=e.slice(r)}}).onIgnoreTag);var _=b(e,function(e,t,r,n,i){var o={sourcePosition:e,position:t,isClosing:i,isWhite:Object.prototype.hasOwnProperty.call(u,r)},a=c(r,n,o);if(null!=a)return a;if(o.isWhite){if(o.isClosing)return"</".concat(r,">");var s=function(e){var t=p.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=p.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=p.trim(e.slice(0,-1))),{html:e,closing:r}}(n),g=u[r],_=k(s.html,function(e,t){var n=-1!==p.indexOf(g,e),i=h(r,e,t,n);return null==i?n?(t=f(r,e,t,null))?"".concat(e,'="').concat(t,'"'):e:null==(i=d(r,e,t,n))?void 0:i:i});return n="<".concat(r),_&&(n+=" ".concat(_)),s.closing&&(n+=" /"),n+=">"}return null==(a=l(r,n,o))?v(n):a},v);return g&&(_=g.remove(_)),_},e}(),x=Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")(),L=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var t,r,n="douyin_web";if(!p.includes(n,"bid"))return n;if(e.config&&e.config.bid)return e.config.bid;if(x&&x._xssBid)return x._xssBid;if(x&&x.slardar&&"function"==typeof x.slardar.config){var i=(x.slardar.config()||{}).bid;if(i)return i}if(x&&x.Slardar&&"function"==typeof x.Slardar.config){var o=(x.Slardar.config()||{}).bid;if(o)return o}return(null===(r=null===(t=null==x?void 0:x.Slardar)||void 0===t?void 0:t._baseParams)||void 0===r?void 0:r.bid)||"argus"},this.getConfigRegion=function(){var t;return p.includes("cn","region")?e.config&&e.config.region?e.config.region:((null===(t=null==x?void 0:x.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():"cn"},this.gerReportUrl=function(){var t={cn:y("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:y("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:y("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.config=e},e.prototype.upload=function(){var e=this,t=this.gerReportUrl();!this.lock&&t&&0!==this.batchData.length&&(this.lock=!0,setTimeout(function(){var r=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),x.fetch(t,{method:"post",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).catch(function(e){}),e.lock=!1,e.upload()},this.timeout))},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t=this.generateKey(e);if(x.fetch&&e.collectKey){var r="object"==typeof window?window.location.href:"SSR";e.documentUrl=r;var n={age:Math.floor(Date.now()),type:"xss",url:r,body:e,"user-agent":""};"enforce"===e.disposition&&"SSR"!==r||(n.url=t),"SSR"===r&&(n.url="SSR___".concat(n.url),n.body.ssr=!0),this.push(n)}},e}()),T=function(e){for(var t=0,r=function(r){Array.isArray(e[r])?0===e[r].length?delete e[r]:(e[r]=p.from(p.uniq(e[r])),t+=e[r].length):0===p.keys(e[r]).length?delete e[r]:p.keys(e[r]).forEach(function(n){e[r][n]=p.from(p.uniq(e[r][n])),t+=e[r][n].length})},n=0,i=p.keys(e);n<i.length;n++)r(i[n]);return{count:t,ret:e}};function S(e,t){return L.setConfig(t),new w(t).process(e)}function R(e){var t,r=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===r)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=e.slice(r+1,-1).trim())[e.length-1];return n&&(e=e.slice(0,-1).trim()),{html:e,closing:n}}var A=function(e){return -1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,function(e,t,r,n){return String.fromCharCode(t?parseInt(r,16):parseInt(n))}).replace(/(\t|\n|\r)/g,"").toLowerCase()};function P(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=A(e),p.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!p.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var r=["expression(","behavior:","view-source:"];if(p.some(r,function(t){return -1!==e.indexOf(t)}))return p.forEach(r,function(r){-1!==e.indexOf(r)&&t&&t(r)}),!1;var n=["data:application","data:javascript","data:text/html","data:texthtml"];if(p.some(n,function(t){return -1!==e.indexOf(t)}))return p.forEach(n,function(r){-1!==e.indexOf(r)&&t&&t(r)}),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var i=e.slice(11).replace(/\s/g,"").trim();return!!p.some(["void","void(0)","void0","false","undefined",";"],function(e){return e===i})||(t&&t("javascript:"),!1)}return!0}var O=function(e,t){var r,n,i="<%= isSaveValidUrl =>";if("string"!=typeof e||(n=Number("<%= urlLimit =>"),void 0!==r&&(n=r),"NaN"!==e.toString()&&-1!==n&&e.length>=n)||P(e,t))return e;try{if(!0===(i=JSON.parse(i))||"true"===i){var o=new URL(e);return o.origin+o.pathname}}catch(e){}return"#"};function D(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!P(e=A(e)))return!1;var i,o={url:(i=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[])[0],scheme:i[1],slash:i[2],host:i[3],port:i[4],path:i[5],query:i[6],hash:i[7]},a=o.scheme,s=o.host;return n?!!n(e):!(!a||!s)&&(!p.includes(["http","https","file"],a)||("object"==typeof window&&window&&(t=r(r([],t,!0),[location.host],!1)),p.some(t,function(e){return!!(e instanceof RegExp&&e.test(s))||e===s})))}var N={a:["target","title","spellcheck","rel"],canvas:[],abbr:["title"],address:[],area:["shape","coords","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:["dir"],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["alt","title","width","height","decoding"],ins:["datetime"],li:[],mark:[],nav:[],ol:["start"],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],delete:[],form:[],strong:[],mask:["maskunits","x","y","width","height","fill"],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],wbr:[],video:["autoplay","controls","loop","preload","height","width"],svg:["viewBox","version","xmlns","fill","width","height","stroke","stroke-width","style"],path:["d","fill","opacity","stroke","p-id","fill-rule","clip-rule","stroke-width","stroke-linecap","stroke-linejoin","fill-opacity","mask"],rect:["x","y","width","height","fill","stroke","rx"],g:[]},I={collect:null,initCollect:function(){this.collect={whiteList:{},filterProtocol:[]}},removeCollect:function(){var e=T(this.collect),t=e.count,r=e.ret;return this.collect=null,{collectKey:0===t?null:JSON.stringify(r),collectMode:"white"}},onIgnoreTagAttr:function(e,t,n){return e&&p.indexOf(["href","src"],t)>-1?I.domainWhiteList&&Array.isArray(I.domainWhiteList)&&I.domainWhiteList.length>0&&!D(n,r([],I.domainWhiteList,!0))?"":"".concat(t,'="').concat(O(n,function(e){var t;null===(t=I.collect)||void 0===t||t.filterProtocol.push(e)}),'"'):e&&(p.indexOf(["style","class","id"],t)>-1||t.indexOf("data-")>-1)?"".concat(t,'="').concat(n,'"'):(I.collect.whiteList[e]=I.collect.whiteList[e]||[],void I.collect.whiteList[e].push(t))},onIgnoreTag:function(e,t){if("style"===e)return t;b(t,function(e,t,r,n){k(R(n).html.replace("/",""),function(e){I.collect.whiteList[r]=I.collect.whiteList[r]||[],I.collect.whiteList[r].push(e)})},v)},whiteList:N,mergeWhiteList:function(e){for(var t,r={},n=0,i=p.keys(N);n<i.length;n++)r[t=i[n]]=p.from(N[t]);for(var o=0,a=p.keys(e);o<a.length;o++)r[t=a[o]]=t in N?N[t].concat(e[t]):p.from(e[t]);return r},setWhiteList:function(e){for(var t=0,r=p.keys(e);t<r.length;t++){var n=r[t];this.whiteList[n]=n in N?N[n].concat(e[n]):p.from(e[n])}}};try{var M={},j="merge";p.includes(j,"override")&&(I.whiteList=M.whiteList),p.includes(j,"merge")&&I.setWhiteList(M.whiteList)}catch(e){}var W=function(e,t){for(var r={},n=0,i=p.keys(e);n<i.length;n++){var o=i[n];Array.isArray(e[o])?r[o]=p.from(e[o]):r[o]=W({},e[o])}for(var a=0,s=p.keys(t);a<s.length;a++)(o=s[a])in e?Array.isArray(e[o])?r[o]=e[o].concat(t[o]):r[o]=W(e[o],t[o]):Array.isArray(t[o])?r[o]=p.from(t[o]):r[o]=W({},t[o]);return r},B={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var F={};F.blackAttrRegExps&&(F.blackAttrRegExps=F.blackAttrRegExps.map(function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))}));var H="merge";p.includes(H,"override")&&(B=F),p.includes(H,"merge")&&(B=W(B,F))}catch(e){}var Z={mode:"black",whiteList:{},blackConfig:B,collect:null,initCollect:function(){Z.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=T(Z.collect),t=e.count,r=e.ret;return Z.collect=null,{collectKey:0===t?null:JSON.stringify(r),collectMode:"black"}},onIgnoreTag:function(e,t){var r;if(!p.includes(B.blackTags,e))return b(t,function(e,t,r,n,i){if(-1!==r.indexOf("/"))return v(n);if(i)return"</".concat(r,">");var o=R(n),a=k(o.html,function(e,t){var n,i=0;if(B.blackList[r]&&p.includes(B.blackList[r],e)&&(Z.collect.blackList[r]=Z.collect.blackList[r]||[],Z.collect.blackList[r].push(e),i++),B.blackAttrRegExps.length&&B.blackAttrRegExps.some(function(t){return t.test(e)})&&p.forEach(B.blackAttrRegExps,function(t){t.test(e)&&(Z.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),i++)}),B.blackAttrs.length&&p.includes(B.blackAttrs,e)&&(B.blackAttrs.push(e),i++),!i){if(B.filterList&&B.filterList[r]&&p.includes(B.filterList[r],e)){var o=O(t,function(e){var t;null===(t=Z.collect)||void 0===t||t.filterProtocol.push(e)});return o!==t&&(Z.collect.filterList[r]=Z.collect.filterList[r]||[],Z.collect.filterList[r].push(e)),t?"".concat(e,"='").concat(o,"'"):e}return B.filterAttrs&&p.includes(B.filterAttrs,e)?((o=O(t,function(e){var t;null===(t=Z.collect)||void 0===t||t.filterProtocol.push(e)}))!==t&&(null===(n=Z.collect)||void 0===n||n.filterAttrs.push(e)),t?"".concat(e,"='").concat(o,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}});return n="<".concat(r),a&&(n+=" ".concat(a)),o.closing&&(n+=" /"),n+=">"},v);null===(r=Z.collect)||void 0===r||r.blackTags.push(e)}},V=function(e){var t=e.reportOnly,r=void 0===t||t,n=e.block;return r&&"all"===r?"report":("string"==typeof r&&("true"===r&&(r=!0),"false"===r&&(r=!1)),n?"enforce":r?"report":"enforce")},U=function(e){return function(r,n,i){if(!r||"string"!=typeof r)return r;var o=n;e===S&&(o=I).initCollect();var a=e(r,o);if(C(a)===C(r))return r;if(!i)return a;var s=i.logType,u=V(i),c=o.removeCollect();return L.report(t(t({type:s,disposition:u},c),{sourceText:m(r),filterText:m(a)})),"enforce"===u?a:r}},G=U(function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new w(t).process(e)}),q=U(S),J=function(e,t,r){var n=[],i=O(e,function(e){n.push(e)});if(i===e)return e;n=p.from(p.uniq(n));var o=t||r||{};if(!o)return i;var a=o.logType,s=V(r);return L.report({type:a,disposition:s,collectKey:n.join("___"),collectData:JSON.stringify(n),collectMode:"black",sourceText:m(e),filterText:m(i)}),"enforce"===s?i:e},K=x._xssProject||{},Y=x.xssNamespace||{},z="3.0.26",X={FilterXSS:w,version:z,webpackPluginVersion:"<%= webpackPluginVersion =>",reportOnly:"<%= reportOnly =>",filterXSS:G,_filterXSS:q,filterUrl:J,Config:I,BlackConfig:Z,project:K,setProjectName:function(e){K[e]=this,x._xssProjectName=e}};Y.douyin_web=X,x.xssNamespace=Y,x.Math&&!x.Math.xssNamespace&&(x.Math.xssNamespace=Y),K[z]=X,x.globalThis=x,x.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:X},x.xss=X,x.isSafeUrl=D,x.isSafeDomain=D,x.isSafeProtocol=P,x._xssProject=K,x._xssProjectName&&(K[x._xssProjectName]=X);var Q=X.setProjectName.bind(X);e.BlackConfig=Z,e.Config=I,e.FilterXSS=w,e._filterXSS=q,e.filterUrl=J,e.filterXSS=G,e.isSafeDomain=D,e.isSafeProtocol=P,e.isSafeUrl=D,e.project=K,e.setProjectName=Q,e.setXssNamespace=function(e){var t=e.appId,r=e.bid,n=e.region;Y[t]=X;I.bid=r,I.region=n,I.enabled=!0},e.xssNamespace=Y,Object.defineProperty(e,"__esModule",{value:!0})});"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["1712"],{167846:function(e,t,r){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{$w:function(){return a},Ac:function(){return E},PA:function(){return s},Vx:function(){return y},XW:function(){return f},Zj:function(){return g},_x:function(){return l},l5:function(){return _},qH:function(){return c},u:function(){return b},x:function(){return o}});function i(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,u,"next",e)}function u(e){i(a,n,o,s,u,"throw",e)}s(void 0)})}}function a(e,t,r){return t=d(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,v()?Reflect.construct(t,r||[],d(e).constructor):t.apply(e,r))}function s(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!({}).hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(v=function(){return!!e})()}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){l(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _(){_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var a=Object.create((r&&r.prototype instanceof g?r:g).prototype);return i(a,"_invoke",{value:function(t,r,n){var i=d;return function(o,a){if(i===f)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=function t(r,n){var i=n.method,o=r.iterator[i];if(o===e)return n.delegate=null,"throw"===i&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+i+"' method")),p;var a=h(o,r.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,p;var s=a.arg;return s?s.done?(n[r.resultName]=s.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):s:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,p)}(s,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var c=h(t,r,n);if("normal"===c.type){if(i=n.done?v:"suspendedYield",c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=v,n.method="throw",n.arg=c.arg)}}}(t,n,new S(o||[]))}),a}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d="suspendedStart",f="executing",v="completed",p={};function g(){}function m(){}function y(){}var b={};c(b,a,function(){return this});var k=Object.getPrototypeOf,E=k&&k(k(R([])));E&&E!==r&&n.call(E,a)&&(b=E);var C=y.prototype=g.prototype=Object.create(b);function w(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function x(e,t){var r;i(this,"_invoke",{value:function(i,o){function a(){return new t(function(r,a){!function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,a,s)},function(e){r("throw",e,a,s)}):t.resolve(l).then(function(e){c.value=e,a(c)},function(e){return r("throw",e,a,s)})}s(u.arg)}(i,o,r,a)})}return r=r?r.then(a,a):a()}})}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw TypeError(typeof t+" is not iterable")}return m.prototype=y,i(C,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:m,configurable:!0}),m.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},w(x.prototype),c(x.prototype,s,function(){return this}),t.AsyncIterator=x,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new x(l(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},w(C),c(C,u,"Generator"),c(C,a,function(){return this}),c(C,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,r,n){var i=h(d(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function b(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},246189:function(e,t,r){r.d(t,{g:function(){return o}});var n=r(101132),i=r(906399),o={onlyInit:!1,useWaterLevel:!1,maxBufferLength:10,minBufferLength:5,tickInSeconds:.2,getLicenseUrl:"",xhrSetup:{},retryCount:1,retryDelay:1e3,timeout:3e3,processMaxGapTime:1/0,preloadCacheType:1,needPreloadRangeList:!1,isOpenPreload:!0,needPreloadCheck:!1,preloadTime:0,preloadMaxCacheCount:0,needAutoBitrate:!0,keyValue:null,drm:null,switchBitRateWay:!1,enableWorker:!1,bufferThreshold:10,removeBufferLen:60,removeBufferAtSeek:!1,resumePlayWaterLevel:2,waitJampBufferMaxCnt:3,waitingInBufferTimeOut:5e3,waitingTimeOut:1e4,notDegradeErrorList:["timeout",403,404],h265Degrade:!1,forceVideoPlay:!1,segmentMinDuration:3,supportHevc:void 0,H264Config:null,reqOptions:{},rangeMaxDuration:15,getRequestOptionsCallback:null,closeDowngrade:!1,loaderType:"fetch",reUseMSE:!1,urlExpireDisableErrorEvent:!1,logCacheConfig:{logCacheLevel:n._.LOG,logMaxSize:204800},noPreloadAddBufferLen:0,enableFPSStuckHandle:!1,loadRangeType:i.TJ.GOP,timerInWorker:!1,waitingRetrySeekTimes:null,waitingRetryDuration:null,disableInactiveWaitingCheck:!1,alwaysStreamingLoad:!0,enableCusExpiryCheck:!1,enableCheckTrackGap:!1,trackGap:1,reqParams:{},isAddRange:!1,disableRepeatRange:!1,audioGroupingStrategy:2}},676400:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(884504);r(577829),r(947478),r(864614),r(632852);var i=r(792048),o=r(241689),a=r.n(o);let s=(0,n.qH)(function e(){(0,n.PA)(this,e),a()(this),this.bodyId=0,this.isSwitchHeader=!1,this.workers={audio:null,video:null},this.init(),this.headerId=0,this.crypto=window.crypto||window.msCrypto},[{key:"init",value:function(){for(var e=this,t=Object.keys(this.workers),r=0;r<t.length;r++){var n=t[r],o=new i.Z;o.onmessage=function(t){e.emit(t.data.method,t.data)},this.workers[n]=o}}},{key:"updateHeaderId",value:function(){var e=this.bodyId+1;this.headerId=e,this.bodyId=e}},{key:"destroy",value:function(){for(var e=Object.keys(this.workers),t=0;t<e.length;t++){var r=e[t];this.workers[r].postMessage({method:"destroy"}),this.workers[r].terminate()}this.workers={}}},{key:"getWorker",value:function(e){return this.workers[e?"video":"audio"]}},{key:"decryptHeader",value:function(e,t){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=this;return this.updateHeaderId(),new Promise(function(i){var o=Math.floor(1e3*Math.random()),a=n.getWorker(t);a&&a.postMessage({method:"decryptHeader",id:o,buf:e,isVideo:t,needRemux:r});var s=function(e){e.id===o&&(n.off("decryptHeader",s),i({data:e.args.data,vid:e.args.vid}))};n.on("decryptHeader",s)})}},{key:"updateValue",value:function(e){for(var t=Object.keys(this.workers),r=0;r<t.length;r++){var n=t[r];this.workers[n].postMessage({method:"updateValue",value:e})}}},{key:"decryptBody",value:function(e,t){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=e instanceof ArrayBuffer?e:e.buffer,i=this,o=i.bodyId+1;return i.bodyId=o,new Promise(function(e){var a=function(t){t.id===o&&(i.off("decryptBody",a),e({data:t.args.data,id:o,headerId:i.headerId}))};i.on("decryptBody",a);var s=i.getWorker(t);s&&s.postMessage({method:"decryptBody",id:o,args:{isVideo:t,id:i.workerIndex,aeskey:i.aeskey,buf:n,needRemux:r}},[n])})}}])},722774:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(884504);r(724356),r(227470);var i=r(569898),o=r(479461),a=(0,n.qH)(function e(t){(0,n.PA)(this,e),this.onTick_=t,this.cancelPending_=null},[{key:"tickAfter",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.stop();var n=!0,i=null;return this.cancelPending_=function(){window.clearTimeout(i),n=!1},i=window.setTimeout(function(){n&&(t.onTick_(),r&&r())},1e3*e),this}},{key:"tickEvery",value:function(e){var t=this;this.tickAfter(e,function(){t.tickEvery(e)})}},{key:"stop",value:function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}]),s={stallSkip:.1,stallCount:3,stallTimer:1,failCount:2},u=function(){function e(t,r){var i=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,n.PA)(this,e),this.player=t,this.mediaElem=t.video,this.config=Object.assign({},r,s),this.timer=new a(function(){i.onGapJump()}),this.inBufferTimer=new a(function(){i._onBufferStallCheck()}),this.prevReadyState=this.mediaElem.readyState,this.didFireLargeGap=!1,this.seekingEventReceived=!1,this.segmentAppended=!1,this.onWaitFunc=this._onWaiting.bind(this),this.onPlayFunc=this._onPlay.bind(this),this.onPlayingFunc=this._onPlaying.bind(this),this.onPausedFunc=this._onPaused.bind(this),this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),this.hasPlayed=!1,this.lastVideoTime=-1,this.hasPaused=!1,this.resumeFromPaused=!1,this.stallSkip=this.config.stallSkip,this.stallCount=this.config.stallCount,this.stallTimer=this.config.stallTimer,this.reset(),this.requests=u,this.player.on(o.X4,function(e){i.requests=e}),!1!==this.config.useGapJump&&this._start()}return(0,n.qH)(e,[{key:"reset",value:function(){this.stallPoints={}}},{key:"_onWaiting",value:function(){this.onGapJump();var e=this.player.currentTime;this.onRequestFail(e)}},{key:"onRequestFail",value:function(e){if(!!this.requests){var t=this.requests.video,r=this.requests.audio,n=this._checkIfNextRequestFailed(e,t),i=this._checkIfNextRequestFailed(e,r);if(n.result||i.result){var o=n.result?n.end:i.end;o=o<this.player.duration-.5?o+.5:this.player.duration,this.player.currentTime=o,this.player&&this.player.emit("log",{type:"oneevent",end_type:"gap_req",vid:this.config.vid,ext:{video_postion:Math.floor(1e3*o)}})}}}},{key:"_checkIfNextRequestFailed",value:function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.start-e<1.5,o=n.start<=e&&e<=n.end,a=(null==n?void 0:n.response.status)!==403;if(i&&o&&n.count>=this.config.failCount&&a)return{end:n.end,result:!0}}return{result:!1}}},{key:"_onPlay",value:function(){this.hasPlayed=!0}},{key:"_onPaused",value:function(){this.hasPaused=!0}},{key:"_onPlaying",value:function(){this.hasPaused&&(this.hasPaused=!1,this.resumeFromPaused=!0)}},{key:"_start",value:function(){this.mediaElem.addEventListener("waiting",this.onWaitFunc),this.mediaElem.addEventListener("play",this.onPlayFunc),this.mediaElem.addEventListener("playing",this.onPlayingFunc),this.mediaElem.addEventListener("pause",this.onPausedFunc),this.timer.tickEvery(.25),this.inBufferTimer.tickEvery(this.stallTimer)}},{key:"onSegmentAppend",value:function(){this.segmentAppended=!0,this.onGapJump()}},{key:"onSeeking",value:function(){this.seekingEventReceived=!0,this.segmentAppended=!1,this.didFireLargeGap=!1}},{key:"onGapJump",value:function(){if(this.mediaElem.readyState===HTMLMediaElement.HAVE_NOTHING)return;if(this.mediaElem.seeking){if(!this.seekingEventReceived)return}else this.seekingEventReceived=!1;if(this.mediaElem.paused&&0!==this.mediaElem.currentTime&&this.hasPlayed)return;this.mediaElem.readyState!==this.prevReadyState&&(this.didFireLargeGap=!1,this.prevReadyState=this.mediaElem.readyState);var t=this.mediaElem.buffered,r=this.config.smallGapLimit||1,n=this.config.gapDetectionThreshold||.5,o=this.mediaElem.currentTime,a=this._getIndex(t,o,n);if(null===a||0===a&&!this.segmentAppended)return;var s=t.start(a);if(s>this.mediaElem.duration)return;var u=s-o,c=u<=r;if(!(u<e.BROWSER_GAP_TOLERANCE))c&&(this.mediaElem.currentTime=this.isSafari?s+.2:s,i.ZP.gap("gapJump gapIndex",a,"isGapSamll",c,"jumpLargeGap",!1,"currentTime",this.mediaElem.currentTime),.08!==s&&this.player&&this.player.emit("log",{type:"oneevent",end_type:"gap",vid:this.config.vid,ext:{video_postion:Math.floor(1e3*s)}}))}},{key:"_onBufferStallCheck",value:function(){if(!!this.mediaElem&&!this.mediaElem.paused&&!this.mediaElem.ended&&0!==this.mediaElem.playbackRate&&0!==this.mediaElem.buffered.length){for(var e=this.mediaElem.currentTime,t=this.mediaElem.buffered,r=!1,n=[],i=0;i<t.length;i++){var o=t.start(i),a=t.end(i);if(n.push({start:o,end:a}),!(e<o-.1)&&!(e>a-.5))r=!0}var s=this.mediaElem.buffered,u=s.length;u>0&&this.mediaElem.duration===s.end(u-1)&&(r=!0);var c=this.mediaElem.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA;if(r&&c&&this.lastVideoTime===e&&!this.resumeFromPaused&&this.mediaElem.currentTime<this.mediaElem.duration)try{void 0===this.stallPoints[e]&&(this.stallPoints[e]=0),this.stallPoints[e]++,this.stallPoints[e]>this.stallCount&&(this.mediaElem.currentTime<this.mediaElem.duration-this.stallSkip?this.mediaElem.currentTime+=this.stallSkip:this.mediaElem.currentTime=this.mediaElem.duration)}catch(e){}this.lastVideoTime=e,this.resumeFromPaused=!1}}},{key:"_getIndex",value:function(e,t,r){if(!e||!e.length||1===e.length&&e.end(0)-e.start(0)<1e-6)return null;for(var n=this._getBuffered(e),i=null,o=0;o<n.length;o++)if(n[o].start>t&&(0===o||n[o-1].end-t<=r)){i=o;break}return i}},{key:"_getBuffered",value:function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}},{key:"destroy",value:function(){this.mediaElem.removeEventListener("waiting",this.onWaitFunc),this.mediaElem.removeEventListener("play",this.onPlayFunc),this.mediaElem.removeEventListener("playing",this.onPlayingFunc),this.mediaElem.removeEventListener("pause",this.onPausedFunc),this.timer.stop(),this.timer=null,this.inBufferTimer.stop(),this.inBufferTimer=null}}])}();u.BROWSER_GAP_TOLERANCE=.001},140709:function(e,t,r){r.d(t,{Z:function(){return b},d:function(){return _}});var n=r(884504);r(514312),r(121621),r(904644),r(585322),r(577829),r(724356),r(947478),r(864614),r(632852),r(616414),r(812735),r(623302),r(983431),r(319386),r(657170),r(853127),r(644952),r(759149),r(949136),r(966922),r(33814),r(29536),r(716005),r(548485),r(260075),r(791017),r(743286),r(310378),r(124539),r(48498),r(728271),r(814647),r(535689),r(659673),r(612222);var i=r(43024),o=r(41866),a=r(54544),s=r(611451),u=r(569898),c=r(280161),l=r(479461),h=r(241689),d=r.n(h),f=r(918334),v=r(203199),p=r(248176);function g(e){if(window.Headers&&e instanceof Headers){var t,r={},i=(0,n.sf)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r[o[0]]=o[1]}}catch(e){i.e(e)}finally{i.f()}return r}return e}var _={loaderCount:1,loaderType:i.t.FETCH,onProcessMinLen:5120,enableDynamicMinLen:!0};function m(e,t){if(e.length>0){for(var r=0,n=!0,i=0;i<e.length;i++){var o=e[i];if(o>t){n=!1;break}if((r+=o)/e.length>t&&(n=!1),!n)return!1}}return!0}var y=0,b=function(){var e,t,r,h,b,k;function E(e,t){var r=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";(0,n.PA)(this,E),d()(this),this._config=Object.assign({},_,(0,n.Zj)({responseType:"arraybuffer"},e)),this._loaderCount=1,this._config.loaderCount>1,this._loaderType=this._config.loaderType||i.t.FETCH,this._enableDynamicMinLen=this._config.enableDynamicMinLen,this._preloadManager=t,e.openLog&&o.Y.enable(),this._videoLoaders=[],this._audioLoaders=[],this._videoIdx=0,this._audioIdx=0;for(var c=0;c<this._loaderCount;c++){var l=new o.Y("".concat(u,"VideoLoader_").concat(c,"_").concat(this._config.vid),this._config.vid),h=new o.Y("".concat(u,"AudioLoader_").concat(c,"_").concat(this._config.vid),this._config.vid),f=new a.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{logger:l,loaderType:this._loaderType})),v=new a.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{logger:h,loaderType:this._loaderType}));this._videoLoaders.push(f),this._audioLoaders.push(v),this._videoSpeeds=[],f.on(s.K.REAL_TIME_SPEED,function(e){y=e.speed,r._cacheSpeed(e)}),v.on(s.K.REAL_TIME_SPEED,function(e){y=e.speed,r._cacheSpeed(e)}),this._videoReqCosts=[]}this._moofVideoLoader=new a.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{loaderType:this._loaderType})),this._moofAudioLoader=new a.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{loaderType:this._loaderType})),this._isSupportUrlRange="fetch"===this._loaderType,this._preloadCacheDatas={},this._reqCost={cdn:{count:0,avg:0},pcdn:{count:0,avg:0}}}return(0,n.qH)(E,[{key:"_cacheProgress",value:function(e,t){var r=t[e];if(r&&r.range&&r.done){var i=v.Z.generateRequestUniqueKey((0,n.Zj)((0,n.Zj)({},r.extData),{},{range:r.range}));if(!i)return;this._preloadCacheDatas[i]={duration:r.extData.segmentDuration,vtype:f.l0.DASH,res:r.data.buffer,mediaType:e,memory:r.data.byteLength,range:r.range,fileId:r.extData.fileId,rangeEnd:r.extData.rangeEnd,rangeStart:r.extData.rangeStart},u.ZP.log("cacheProgress",i,JSON.stringify(this._preloadCacheDatas[i]))}}},{key:"cachePreloadData",value:(e=(0,n.x)((0,n.l5)().mark(function e(t,r){var i,o,a;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.vid){e.next=2;break}return e.abrupt("return");case 2:if(this._cacheProgress("video",r),this._cacheProgress("audio",r),t.vtype=p.Z.vtype,i=Object.keys(this._preloadCacheDatas).length,!(this._preloadManager&&i>0)){e.next=11;break}return e.next=9,this._preloadManager.getItem(t,!0);case 9:(o=e.sent)?(a=Object.assign({},o,this._preloadCacheDatas),a=v.Z.combinePreloadData(a),this._preloadManager.setItem(t,a,!0)):this._preloadManager.setItem(t,this._preloadCacheDatas,!0);case 11:this._preloadCacheDatas={};case 12:case"end":return e.stop()}},e,this)})),function(t,r){return e.apply(this,arguments)})},{key:"isSupportedProgress",value:function(){return 1===this._loaderCount&&"fetch"===this._loaderType}},{key:"_addCost",value:function(e){this._videoReqCosts.push(e),this._videoReqCosts.length>3&&this._videoReqCosts.shift()}},{key:"_addVideoSpeed",value:function(e){this._videoSpeeds.push(e),this._videoSpeeds.length>3&&this._videoSpeeds.shift()}},{key:"checkProgressSatisfied",value:function(e){var t=!1;if(navigator.connection&&navigator.connection.downlink)return t=!0,!(5*e/(1e6*navigator.connection.downlink)>4)&&!0;if(!m(this._videoReqCosts,4))return!1;var r=this._videoSpeeds.map(function(t){return 5e3*t/e});if(!m(r,4))return!1;if(!t&&0===r.length)try{try{var n=parseFloat(c.Xb.getItem(l.OU))||0;if(0===n||5e3*n/e>4)return!1}catch(e){}}catch(e){}return!0}},{key:"_cacheSpeed",value:function(e){var t,r=e.speed;E.historySpeed.length>=20&&E.historySpeed.shift(),E.historySpeed.push(r),this.emit(s.K.REAL_TIME_SPEED,(0,n.Zj)({speed:r,type:(null==e||null===(t=e.priOptions)||void 0===t?void 0:t.type)||l._R.CDN},e))}},{key:"_calCostTime",value:function(e,t){var r=this._reqCost[e?"pcdn":"cdn"];t<3*r.avg&&(r.count++,r.avg=(r.avg*(r.count-1)+t)/r.count)}},{key:"getReqCost",value:function(e){var t=this._reqCost[e];return(null==t?void 0:t.avg)||0}},{key:"load",value:(t=(0,n.x)((0,n.l5)().mark(function e(t,r,i,o){var a,s,c,h,d,_,m,y,b,k,E,C,w,x,L,T,S,R,A,P,O,D,N,I,M,j,W=arguments;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=W.length>4&&void 0!==W[4]&&W[4],s=W.length>5&&void 0!==W[5]?W[5]:null,c=W.length>6&&void 0!==W[6]?W[6]:null,h=W.length>7&&void 0!==W[7]?W[7]:null,d=W.length>8&&void 0!==W[8]?W[8]:null,o.vtype=f.l0.DASH,o.isPreload=a,o.range=i,_={start:o.start,end:o.end,bandwidth:o.bandwidth||o.bitrate,sequence:o.idx,fps:o.fps,mediaType:t,selectedIdx:o.selectedIdx,definition:o.definition,range:i.concat(),startRaw:o.startRaw,endRaw:o.endRaw},m=this._config.onProcessMinLen,this._enableDynamicMinLen&&_.bandwidth&&s&&(y=0===o.start?.5:1,m=Math.floor(_.bandwidth*y/8)),!(this._preloadManager&&o.checkPreload)){e.next=25;break}if(b=v.Z.nowTime(),k=null,!this._preloadManager.supportSync()){e.next=18;break}k=this._preloadManager.getPreLoadDataSync(o),e.next=21;break;case 18:return e.next=20,this._preloadManager.getPreLoadData(o);case 20:k=e.sent;case 21:if(!(k&&k.res instanceof ArrayBuffer)){e.next=25;break}return u.ZP.log("changeState preload hit cache",k.cacheKey,"cost",v.Z.nowTime()-b,"ms","isPreload",a),s&&s(k.res,!0,{range:i,fromCache:!0},null,o),e.abrupt("return",{res:k.res,headers:k.headers,status:k.status,fromCache:!0,selectedIdx:o.selectedIdx,extData:_,orgDefinition:k.orgDefinition,cacheKey:k.cacheKey,duration:k.duration});case 25:if(E=o.isPCDN,C=(!s||this._isSupportUrlRange)&&(this._config.useUrlRange||o.useUrlRange||!1)&&!E,w=r,C&&i&&i.length>1&&(w="".concat(r+(r.split("?")[1]?"&":"?"),"range=").concat(i[0],"-").concat(i[1])),(!i||0===i.length||C)&&(i=void 0),x=performance.now(),u.ZP.log(this._config.vid,"load res start:",JSON.stringify(o),"startTime",x,"userUrlRange",C,"onProgress",!!s,"onProcessMinLen",m),e.prev=33,T=this._getLoader(t,o)){e.next=37;break}return e.abrupt("return");case 37:return S=this._config.headers||{},R=o.reqOptions||{},e.next=41,T.load(w,(0,n.Zj)({range:i,onProgress:s,selectedIdx:o.selectedIdx,sequence:o.idx,initSegment:o.initSegment,onProcessMinLen:m,onCancel:c,timeout:h,onTimeout:d,headers:E?Object.assign({},S,{"X-Origin-Server-Host":o.cdnHost}):S,priOptions:{type:E?l._R.PCDN:l._R.CDN,extData:o}},R));case 41:if(A=e.sent){e.next=44;break}return e.abrupt("return",null);case 44:return"video"===t&&this._addCost((performance.now()-x)/1e3),P=A.data,O=A.response,D={res:P instanceof Uint8Array?P.buffer:P,headers:g(O.headers),status:O.status,duration:o.end-o.start||0,memory:P.byteLength,vtype:p.Z.vtype,mediaType:t,costTime:0,range:i,isInitSegment:o.initSegment,fileId:o.fileId},N=performance.now()-x,u.ZP.log("load res finish: ",JSON.stringify(o),"cost time",N,"ms","range",null===(L=D.headers)||void 0===L?void 0:L["content-range"]),this._calCostTime(E,N),o.checkPreload&&!P.done&&(I=v.Z.generateRequestUniqueKey(o),this._preloadCacheDatas[I]=D),e.abrupt("return",(0,n.Zj)((0,n.Zj)({},D),{},{extData:_,selectedIdx:o.selectedIdx,isPCDN:E,costTime:N,url:r}));case 54:return e.prev=54,e.t0=e.catch(33),u.ZP.log("loader error",{msg:e.t0.message}),e.abrupt("return",{res:"error",status:null===(M=e.t0.response)||void 0===M?void 0:M.status,header:g(null===(j=e.t0.response)||void 0===j?void 0:j.headers),error:e.t0,isPCDN:E,url:w,bitrate:o.bandwidth||_.bandwidth,costTime:-1});case 58:case"end":return e.stop()}},e,this,[[33,54]])})),function(e,r,n,i){return t.apply(this,arguments)})},{key:"_getLoader",value:function(e,t){var r="video"===e;if(t.moof)return r?this._moofVideoLoader:this._moofAudioLoader;if(t.initSegment){var n=r?this._moofVideoLoader:this._moofAudioLoader;if(n&&null!==n._currentTask)return n}if(r){var i=this._videoLoaders[this._videoIdx];return this._videoIdx++,this._videoIdx>=this._videoLoaders.length&&(this._videoIdx=0),i}var o=this._audioLoaders[this._audioIdx];return this._audioIdx++,this._audioIdx>=this._audioLoaders.length&&(this._audioIdx=0),o}},{key:"cancel",value:(r=(0,n.x)((0,n.l5)().mark(function e(t){var r;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return r="video"===t?this._videoLoaders:this._audioLoaders,e.next=4,this.cancelLoaders(r);case 4:e.next=10;break;case 6:return e.next=8,this.cancelLoaders(this._audioLoaders);case 8:return e.next=10,this.cancelLoaders(this._videoLoaders);case 10:if(!this._moofVideoLoader){e.next=13;break}return e.next=13,this._moofVideoLoader.cancel();case 13:if(!this._moofAudioLoader){e.next=16;break}return e.next=16,this._moofAudioLoader.cancel();case 16:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"cancelLoaders",value:(h=(0,n.x)((0,n.l5)().mark(function e(t){var r,i,o;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,n.sf)(t),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=9;break}return o=i.value,e.next=7,o.cancel();case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),r.e(e.t0);case 14:return e.prev=14,r.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),function(e){return h.apply(this,arguments)})},{key:"getCurrentTask",value:function(e){var t="video"===e,r=t?this._moofVideoLoader:this._moofAudioLoader,n=t?this._videoLoaders[0]:this._audioLoaders[0];return(null==r?void 0:r._currentTask)||(null==n?void 0:n._currentTask)}},{key:"cancelTasks",value:(b=(0,n.x)((0,n.l5)().mark(function e(t){var r,i,o,a,s=arguments;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]&&s[1],o=(i="video"===t)?this._moofVideoLoader:this._moofAudioLoader,a=i?this._videoLoaders[0]:this._audioLoaders[0],!o){e.next=7;break}return e.next=7,this._filterTask(o,r);case 7:if(!a){e.next=10;break}return e.next=10,this._filterTask(a,r);case 10:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"_filterTask",value:(k=(0,n.x)((0,n.l5)().mark(function e(t,r){var i,o,a,s,u,c,l,h;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i=[],o=t._queue,r&&t._currentTask&&i.push(t._currentTask.cancel()),a=o.length-1;a>-1;a--)l=null===(s=(c=o[a]).priOptions)||void 0===s||null===(s=s.extData)||void 0===s?void 0:s.isInitSegment,h=null===(u=c.priOptions)||void 0===u||null===(u=u.extData)||void 0===u?void 0:u.isSlice,!(l||h)&&(i.push(c.cancel()),o.splice(a,1));return e.next=6,Promise.all(i);case 6:case"end":return e.stop()}},e)})),function(e,t){return k.apply(this,arguments)})},{key:"destroy",value:function(){this.cancel();for(var e=0;e<this._videoLoaders.length;e++){var t=this._videoLoaders[e];t&&t.removeAllListeners();var r=this._audioLoaders[e];r&&r.removeAllListeners()}this._moofAudioLoader&&this._moofAudioLoader.removeAllListeners(),this._moofVideoLoader&&this._moofVideoLoader.removeAllListeners(),this._audioLoaders=[],this._videoLoaders=[]}}],[{key:"currentSpeed",get:function(){return y}},{key:"historyAvspeed",get:function(){var e=E.historySpeed.reduce(function(e,t){return e+t},0);return 0===E.historySpeed.length?0:e/E.historySpeed.length}}])}();b.historySpeed=[]},728898:function(e,t,r){r.d(t,{LQ:function(){return b},Xv:function(){return p},s8:function(){return y}});var n=r(811156),i=r(159322),o=r.n(i),a=r(109494),s=r(639569),u=r(171138),c=r(458862),l=r(661854),h=r(32493),d=r(166960),f=r(12337),v="sr_canvas",p="xgplayer-sr",g=null,_=0,m=function(e){(0,n.XW)(r,e);var t=(0,n.WY)(r);function r(e){(0,n.PA)(this,r),i=t.call(this),(0,n._x)((0,n.Lc)(i),"_mediaPlayer",null),(0,n._x)((0,n.Lc)(i),"_superWasmModule",null),(0,n._x)((0,n.Lc)(i),"_isVideoFrameCallbackSupported",(0,s.lE)()),(0,n._x)((0,n.Lc)(i),"_readyPromise",(0,c.Qo)()),(0,n._x)((0,n.Lc)(i),"_loadDataPromise",null),(0,n._x)((0,n.Lc)(i),"_wasmReady",!1),(0,n._x)((0,n.Lc)(i),"_isCanvasAdded",!1),(0,n._x)((0,n.Lc)(i),"_canvas",null),(0,n._x)((0,n.Lc)(i),"_convasContainer",null),(0,n._x)((0,n.Lc)(i),"_opts",null),(0,n._x)((0,n.Lc)(i),"_running",!1),(0,n._x)((0,n.Lc)(i),"_forceRunning",!0),(0,n._x)((0,n.Lc)(i),"_code",u.te.SUCCESS),(0,n._x)((0,n.Lc)(i),"_codeMsg",""),(0,n._x)((0,n.Lc)(i),"_renderId",-1),(0,n._x)((0,n.Lc)(i),"_resizeObserver",null),(0,n._x)((0,n.Lc)(i),"_root",null),(0,n._x)((0,n.Lc)(i),"_video",null),(0,n._x)((0,n.Lc)(i),"_onRenderCallback",null),(0,n._x)((0,n.Lc)(i),"_onRenderLostCallback",null),(0,n._x)((0,n.Lc)(i),"_onSRCodeChanged",null),(0,n._x)((0,n.Lc)(i),"_logger",new h.Z("SrCore")),(0,n._x)((0,n.Lc)(i),"_stats",new d.Z),(0,n._x)((0,n.Lc)(i),"_hasGLLoged",!1),(0,n._x)((0,n.Lc)(i),"_isSoftVideo",!1),(0,n._x)((0,n.Lc)(i),"_dropRateEwma",new f.Z(10)),(0,n._x)((0,n.Lc)(i),"_useVideoTexture",!1),(0,n._x)((0,n.Lc)(i),"_preVideoWidth",-1),(0,n._x)((0,n.Lc)(i),"_preVideoHeight",-1),(0,n._x)((0,n.Lc)(i),"_onWebGlContextLost",function(e){if(e.preventDefault(),i.code!==u.te.WEBGL_CONTEXT_LOST)i._codeMsg="WEBGL Context LOST",i.code=u.te.WEBGL_CONTEXT_LOST}),(0,n._x)((0,n.Lc)(i),"_doAppendCanvas",function(){if(!!i._running){if(i._isCanvasAdded)!l.ZP.hasClass(i._root,p)&&i._showCanvas();else{if(!i.video)return;i._root=i.video.parentElement,i._root.insertBefore(i._convasContainer,i.video),i._showCanvas(),i.video instanceof HTMLVideoElement&&(i.video.__canvas=i._canvas),i._isCanvasAdded=!0}i._adjustCanvasPosition()}}),(0,n._x)((0,n.Lc)(i),"_onFrameCallback",function(){if(!!i._running&&!!i.video)i.video.cancelVideoFrameCallback(i._renderId),i._renderId=i.video.requestVideoFrameCallback(i._onFrameCallback),i._onRender()}),(0,n._x)((0,n.Lc)(i),"_onRequestAnimationFrame",function(){if(!!i._running&&!!i.video)cancelAnimationFrame(i._renderId),i._renderId=requestAnimationFrame(i._onRequestAnimationFrame),i._onRender()}),(0,n._x)((0,n.Lc)(i),"_adjustCanvasPosition",function(){if(!!i.video){var e=i._convasContainer,t=i._canvas,r=i.video,n=r.videoWidth,o=r.videoHeight,a=n/o,s=e.clientWidth/e.clientHeight;t.style.width=n,t.style.height=o,a>=s?(t.style.width="100%",t.style.height="auto"):a<s&&(t.style.width="auto",t.style.height="100%")}}),i._opts=(0,u.Rl)(e),i._useVideoTexture=i._opts.useVideoTexture,i._logger.log("Constructor opts",JSON.stringify(i._opts));var i,o,a=!1;!i._opts.wasmUrl&&(i.code=u.te.WASM_URL_MISS,i._codeMsg="WASM_URL_MISS",i._logger.log("ERROR, WASM_URL_MISS"),a=!0);var v=(0,h.h)();try{!(0,c.QC)([HTMLCanvasElement.prototype.getContext,WebGL2RenderingContext.prototype.linkProgram,WebGL2RenderingContext.prototype.createShader])&&!v&&(i.code=u.te.HIJACK,i._codeMsg="API HIJACK",i._logger.log("API HIJACK"),a=!0)}catch(e){}return!a&&(!v&&i._hijack(),i._useVFC=i._opts.useVFC,i._isCrossOrigin=(null===(o=i._opts.videoConfig)||void 0===o?void 0:o.crossOrigin)==="anonymous",i._createCanvas(),i._initSuperModule()),i}return(0,n.qH)(r,[{key:"_hijack",value:function(){try{WebGL2RenderingContext&&WebGL2RenderingContext.prototype&&(WebGL2RenderingContext.prototype.getShaderSource=function(){},WebGL2RenderingContext.prototype.getAttachedShaders=function(){return[]})}catch(e){}}},{key:"_createCanvas",value:function(){this._canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this._canvas.id=this._getCanvasId(),l.ZP.addClass(this._canvas,"object-fit-content"),this._convasContainer=document.createElementNS("http://www.w3.org/1999/xhtml","div"),this._convasContainer.appendChild(this._canvas),l.ZP.addClass(this._convasContainer,"object-fit-container"),this._bindObserver(),document.body.appendChild(this._convasContainer),this._opts.enableContextmenu&&this._canvas&&this._canvas.addEventListener("contextmenu",this.onContextmenu,!1),this._canvas.addEventListener("webglcontextlost",this._onWebGlContextLost,!1)}},{key:"onContextmenu",value:function(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.stopPropagation?e.stopPropagation():(e.returnValue=!1,e.cancelBubble=!0)}},{key:"_bindObserver",value:function(){var e=this;"function"==typeof ResizeObserver?(this._resizeObserver=new ResizeObserver(function(){if(!!e._isCanvasAdded)window.requestAnimationFrame(function(){e._adjustCanvasPosition()})}),this._resizeObserver.observe(this._convasContainer)):(this._onDebounceResize=(0,c.Ds)(this._adjustCanvasPosition,200),window.addEventListener("resize",this._onDebounceResize,!0),"function"==typeof MutationObserver&&(this._mutationsObserver=new MutationObserver(this._onDebounceResize),this._mutationsObserver.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})))}},{key:"_getCanvasId",value:function(){return this._opts.canvasId||v}},{key:"_showCanvas",value:function(){this._root&&(this._setCanvasWidthHeight(),l.ZP.addClass(this._root,p))}},{key:"_setCanvasWidthHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._canvas,r=this._getWidthHeight(),n=r.width,i=r.height;!e&&(t.style.width=n+"px",t.style.height=i+"px");var o=this._opts.useScale?u.s8[this._opts.scaleType]:1;this.statMark(d.E.SETWIDTHHEIGHT),t.width=Math.floor(n*o),t.height=Math.floor(i*o),this.statEndMark(d.E.SETWIDTHHEIGHT)}},{key:"_getWidthHeight",value:function(){var e=this.video,t=e.videoWidth||e.width;return{width:t,height:e.videoHeight||e.height}}},{key:"_hideCanvas",value:function(){this._root&&l.ZP.removeClass(this._root,p)}},{key:"hideCanvas",value:function(){this._hideCanvas()}},{key:"showCanvas",value:function(){this._showCanvas()}},{key:"_initSuperModule",value:function(){var e=this,t=this;this._stats.mark(d.E.LOAD_WASM),this._superWasmModule={wasmBinaryFile:t._opts.wasmUrl,onRuntimeInitialized:function(){t._readyPromise.resolve(),t._stats.endMark(d.E.LOAD_WASM)},print:function(e){t._logger.logMessage("print:",e)},printErr:function(e){t._logger.log("printError:",e)},onAbort:function(e){t._logger.log("onAbort",e),t._readyPromise.reject(Error("LoadFail")),t._wasmReady=!1,t.code=u.te.WASM_LOADED_FAILED,t._codeMsg="WASM_LOADED_FAILED"}},this._logger.log("Module init"),(0,a.Z)(this._superWasmModule),t._readyPromise.then(function(){var r,n=e._superWasmModule,i="#".concat(e._getCanvasId(),"\0"),o=new TextEncoder().encode(i),a=n._malloc(o.byteLength+1);n.HEAPU8.set(o,a);var s=t._opts,c=s.algType,l=s.backend,h=s.scaleType,f=s.maxWidth,v=s.maxHeight,p=s.poolSize;t._stats.mark(d.E.WASM_INIT),t._logger.log("algType:".concat(c,", backend:").concat(l,", scaleType:").concat(h,", maxWidht:").concat(f,", maxHeight:").concat(v,", poolSize:").concat(p));var g=n._createContext(a,c,l,h,p,f,v,1);t._stats.endMark(d.E.WASM_INIT),t._logger.log("CreateContext result:".concat(g));var _=t.getError(!0);n._free(a),0===g&&0===_?(t._logger.log("CreateContext SUCCESS"),t._wasmReady=!0):(t.code=u.te.WASM_INIT_FAIL,t._codeMsg="CreateContextFail code:".concat(g,", codeMsg:").concat(null===(r=u.eO[g])||void 0===r?void 0:r.msg,", errRet:").concat(_),t._wasmReady=!1,t._logger.log("CreateContext Fail, Fail code",g))}).catch(function(e){t.code=u.te.WASM_INIT_FAIL;var r=JSON.stringify({errMsg:e.message,columnNumber:e.columnNumber,fileName:e.fileName});t._codeMsg="CreateContextCatch ".concat(r),t._wasmReady=!1,t._logger.log("Module init catch",r),e.message.indexOf("Cannot read properties of undefined (reading 'createShader')")>-1&&(0,s.HR)(!0)})}},{key:"readyPromise",get:function(){return this._readyPromise}},{key:"isContextReady",get:function(){return this._wasmReady}},{key:"video",get:function(){return this._video}},{key:"bindMediaElement",value:function(e,t){var r=t.onRenderCallback,n=t.onRenderLostCallback,i=t.onSRCodeChanged;if(this._video!==e)this._video&&this.unBindMediaElement(),this._onRenderCallback=r,this._onRenderLostCallback=n,this._onSRCodeChanged=i,this._video=e,this._superWasmModule.video=this._getRenderTex(),this._hasDelayedAddCanvas=!1}},{key:"_getRenderTex",value:function(){return this.video?this.video instanceof HTMLVideoElement?this.video:this.video.canvas:null}},{key:"_tryRender",value:function(){var e=this;this._readyPromise.then(function(){e._superWasmModule.video=e._getRenderTex(),e.isUseVideoFrame?e._onFrameCallback():e._onRequestAnimationFrame()})}},{key:"isUseVideoFrame",get:function(){return this._useVFC&&this._isVideoFrameCallbackSupported&&this.video&&!!this.video.requestVideoFrameCallback}},{key:"_onRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!document.hidden&&"hidden"!==document.visibilityState){var t=this._opts.useScale?u.s8[this._opts.scaleType]:1,r=this.video;try{this._stats.mark(d.E.RENDER);var n=(0,h.h)();!this._hasGLLoged&&this._stats.mark(d.E.GETERRORRENDER);var i=!0,o=this._superWasmModule&&this._superWasmModule.video&&this._superWasmModule.video instanceof HTMLVideoElement;if(o&&0===this._superWasmModule.video.readyState&&(i=!1),this._superWasmModule.video&&i){var a=this._superWasmModule.video.videoWidth,s=this._superWasmModule.video.videoHeight,c=this._useVideoTexture?1:0;if(o){var l=a>=this._opts.maxWidth,f=s>=this._opts.maxHeight;if(l||f){this._onRenderCallback({code:u.te.LIMIT_WIDTH_HEIGHT,msg:"Invalid width or height"});return}}-1===this._preVideoHeight&&(this._preVideoHeight=s,this._preVideoWidth=a),(this._preVideoHeight!==s||this._preVideoWidth!==a)&&(this._setCanvasWidthHeight(!0),this._logger.log("canvas size change"),this._preVideoHeight=s,this._preVideoWidth=a);var v=this._superWasmModule._drawFrame(r.videoWidth,r.videoHeight,t,n||!this._hasGLLoged?1:0,c);if(!this._hasGLLoged&&this._stats.endMark(d.E.GETERRORRENDER),this._hasGLLoged=!0,this._stats.endMark(d.E.RENDER),e&&v!==u.te.SUCCESS)return;this._onRenderCallback({code:v}),this._hasDelayedAddCanvas&&!this._isCanvasAdded&&this._doAppendCanvas(),this._hasDelayedAddCanvas=!0}else this._logger.log("render video not exist, destroyed")}catch(e){var p,g="",_=null==e?void 0:null===(p=e.stack)||void 0===p?void 0:p.includes("contains cross-origin data"),m=this._superWasmModule&&this._superWasmModule.video&&this._superWasmModule.video instanceof HTMLVideoElement;_&&m&&(g="crossorigin:"+this._superWasmModule.video.getAttribute("crossorigin")+",set:"+this._isCrossOrigin);var y=JSON.stringify({errMsg:e.message,columnNumber:e.columnNumber,fileName:e.fileName,stack:null==e?void 0:e.stack});this._onRenderCallback&&this._onRenderCallback({code:-1,error:y,errMsg:e.message+g})}}}},{key:"doRender",value:function(){this.video.paused?this._isCanvasAdded&&(!l.ZP.hasClass(this._root,p)&&this._showCanvas(),this._onRender()):(!l.ZP.hasClass(this._root,p)&&this._showCanvas(),this.run())}},{key:"run",value:function(){this._running=!0,this._tryRender()}},{key:"stop",value:function(){this._running=!1,this._doAppendCanvas()}},{key:"unBindMediaElement",value:function(){this._hideCanvas(),this._isCanvasAdded=!1,this._onRenderLostCallback&&this._onRenderLostCallback(),this._superWasmModule&&(this._superWasmModule.video=null),this.video&&this.video instanceof HTMLVideoElement&&(this.video.__canvas=null),this._video=null,this._root=null,this._onRenderCallback=null,this._onRenderLostCallback=null}},{key:"destroy",value:function(){var e,t;this._useVFC&&this._isVideoFrameCallbackSupported?null===(t=this._superWasmModule.video)||void 0===t||t.cancelVideoFrameCallback(this._renderId):cancelAnimationFrame(this._renderId),this.unBindMediaElement();try{this._superWasmModule._destroy(),this._superWasmModule.video=null,this._superWasmModule=null}catch(e){this.code,u.te.WASM_LOADED_FAILED}this._resizeObserver?this._resizeObserver.unobserve(this._convasContainer):(window.removeEventListener("resize",this._onDebounceResize),this._mutationsObserver.disconnect()),this._opts.enableContextmenu&&this._canvas&&this._canvas.removeEventListener("contextmenu",this.onContextmenu),this._convasContainer.removeChild(this._canvas),null===(e=this._convasContainer.parentElement)||void 0===e||e.removeChild(this._convasContainer),this._canvas.removeEventListener("webglcontextlost",this._onWebGlContextLost)}},{key:"setRunning",value:function(e){this._running=e,e&&this._code===u.te.SUCCESS?(this.code=u.te.SUCCESS,this._codeMsg="SUCCESS",this.run()):this._hideCanvas()}},{key:"code",get:function(){return this._code},set:function(e){this._code=e,this._onSRCodeChanged&&this._onSRCodeChanged(e)}},{key:"codeMsg",get:function(){return this._codeMsg}},{key:"getStat",value:function(){var e=this._stats.getStat();return e.dropRate=this.getDropRate(),e}},{key:"getLog",value:function(){return this._logger.getLogs()}},{key:"getError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||this._wasmReady){var t=this._superWasmModule._getError();return this._logger.log("getError ".concat(t)),t}return 0}},{key:"getRuntimeInfo",value:function(){var e=this._superWasmModule._getRunInfo(),t=this._superWasmModule.UTF8ToString(e);return this._logger.log("getRuntimeInfo ".concat(t)),t}},{key:"resetLogState",value:function(){this._hasGLLoged=!1}},{key:"statMark",value:function(e){return this._stats.mark(e)}},{key:"statEndMark",value:function(e){return this._stats.endMark(e)}},{key:"hasReport",get:function(){return this._hasReport},set:function(e){this._hasReport=e}},{key:"recordDropRate",value:function(e){this._dropRateEwma.sample(1,e)}},{key:"getDropRate",value:function(){return this._dropRateEwma.getEstimate()||0}}]),r}(o());function y(e,t){return e?(!g&&(g=new m((0,n.Zj)((0,n.Zj)({},t),{},{canvasId:"".concat(v).concat(++_)}))),g):new m((0,n.Zj)((0,n.Zj)({},t),{},{canvasId:"".concat(v).concat(++_)}))}function b(){g&&(g.destroy(),g=null)}},518490:function(e,t,r){r.d(t,{ZP:function(){return f},gH:function(){return p},vK:function(){return l},vP:function(){return h},zP:function(){return v}});var n=r(989798);r(561999),r(904644),r(969642),r(766282),r(947478),r(864614),r(210434);var i=r(82380),o=r(438412),a=r(799618),s=r(194235),u=r(337405),c=20,l={DEFAULT:"default",BITRATE_ADAPTER:"bitRateAdapter",USER_SELECT:"userSelect",OVER_SCORE:"overscore"},h={SIMPLE:"simple",BUFFER_INFO:"buffer-info",BANDWIDTH:"bandwidth-buffer"},d={AVG:"avg",WEIGHT:"weight"},f=(0,n.qH)(function e(t,r){var s=this;(0,n.PA)(this,e),this.config=e.defaultConfig;var u=t.config||{};Object.keys(u).map(function(e){s.config[e]=u[e]}),this.speed=0,this._selectorMap={},this._selectorMap[h.SIMPLE]=new o.d,this._selectorMap[h.BUFFER_INFO]=new i._(r,this.config),this._selectorMap[h.BANDWIDTH]=new a.v(r,this.config)},[{key:"select",value:function(e,t,r){if(!this.config.disabled){t=t||this.config.mode;var n=this.config,i=n.bitrateRange,o=n.defaultBitrate,a=n.bitrateKey,u=(e=(0,s.QS)(e,a)).filter(function(e){return e._xgOrgBitrate>=i[0]&&e._xgOrgBitrate<=i[1]}).sort(function(e,t){return t._xgOrgBitrate-e._xgOrgBitrate});if(!u.length){var c,l=1/0;e.forEach(function(e){var t=Math.abs(e._xgOrgBitrate-o);t<l&&(c=e,l=t)}),c&&u.push(c)}this.speed=r||v(this.config.speedAlgoType);var h=(this._selectorMap[t]||this._selectorMap.simple).select(u,this.speed,this.config)||u[0];return h&&(h.filterRateCnt=(null==u?void 0:u.length)||0,h.isFilterMaxRate=p(u,h),h.bitrateSetSelector=u.map(function(e){return e.gearName}),h.qualityBitrateSelector=u.map(function(e){return e.qualityType+":"+e._xgOrgBitrate})),h}}},{key:"selector",get:function(){var e=this.config.mode;return this._selectorMap[e]||this._selectorMap.simple}},{key:"getTargetBitrate",value:function(e,t){var r=this.selector;if(r&&r.getTargetBitrate)return r.getTargetBitrate(e,t)}},{key:"addSelect",value:function(e,t){this._selectorMap[e||t.name]=t}},{key:"destroy",value:function(){var e=this._selectorMap;Object.keys(e).forEach(function(t){"function"==typeof e[t].destroy&&e[t].destroy()})}}],[{key:"defaultConfig",get:function(){return{paramBf:.3,paramBp:.5,paramUpper:1.5,paramLower:.6,paramUpperBl:.7,paramVl1:.7,paramVl2:1e3,paramVlUpper:.9,paramVlLower:.8,bitrateUpper:2e6,bitrateLower:2e5,slidingWindowType:"by_weight",slidingWindowWeight:"size",slidingWindowWeightThreshold:3e5,slidingWindowCountThreshold:30,slidingWindowExtraction:"weighted_median",bitrateRange:[2e5,25e5],defaultBitrate:1e6,autoBitrateParams:{paramA:0,paramB:404330129e-17,paramC:.0164405979,paramD:225511.28,minBitrate:2e5},mSpeedRecordValidThreshold:2,mode:h.SIMPLE,needCheckDuration:!0,overscore:{isOpen:!1,enable266:!0,filterKey:"definition",filterList:[],scoreMultiple:2},bitrateKey:"bitrate"}}},{key:"MaxQueueCapacity",get:function(){return c},set:function(e){c=e}}]);function v(e){var t=0;return e&&e!==d.AVG?e===d.WEIGHT&&(t=u.Z.getWeightedSpeedKbs()):t=u.Z.getAvgSpeedKbs(),Math.max(1024*t,0)}function p(e,t){if(!(null!=e&&e.length)||!t||!t._xgOrgBitrate)return -1;var r,n,i=e.length-1;return((null===(r=e[0])||void 0===r?void 0:r._xgOrgBitrate)>=(null===(n=e[e.length-1])||void 0===n?void 0:n._xgOrgBitrate)&&(i=0),e[i]._xgOrgBitrate<=t._xgOrgBitrate)?1:0}},225427:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(673295);r(766282),r(514312),r(864614),r(632852),r(947478);var i=r(493820);let o=function(){function e(){(0,n.PA)(this,e)}return(0,n.qH)(e,[{key:"_initStorage",value:function(e){var t=e.name,r=e.storeName,i="".concat(t,"_").concat(r);return this.key=i,(!window[i]||"object"!==(0,n.Ac)(window[i]))&&(window[i]={}),this.store=window[i],Promise.resolve()}},{key:"getItem",value:function(e,t){var r=this.store[e];return void 0===r&&(r=null),this._internalPromise(t,r)}},{key:"getItemSync",value:function(e,t){var r=this.store[e];return void 0===r&&(r=null),t&&t(r),r}},{key:"setItem",value:function(e,t,r){return this.store[e]=t,this._internalPromise(r)}},{key:"removeItem",value:function(e,t){return delete this.store[e],this._internalPromise(t)}},{key:"clear",value:function(e){return this.store={},window[this.key]={},this._internalPromise(e)}},{key:"length",value:function(e){var t=Object.keys(this.store).length;return this._internalPromise(e,t)}},{key:"_internalPromise",value:function(e,t){var r=t?Promise.resolve(t):Promise.resolve();return(0,i.Z)(r,e),r}},{key:"all",value:function(e){for(var t=[],r=Object.keys(this.store),n=0;n<r.length;n++){var i=r[n];t.push({key:i,value:this.store[i]})}return this._internalPromise(e,t)}},{key:"probeSupport",value:function(){return!0}}]),e}()},239001:function(e,t,r){r.d(t,{N:function(){return i}});var n=r(84498);r(724356);var i=function(){function e(t,r){(0,n.PA)(this,e),this.config=t,this.instManager=r}return(0,n.qH)(e,[{key:"updateConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!!e)t?Object.assign(this.config,e):this.config=e}}]),e}()},274005:function(e,t,r){r.d(t,{J:function(){return i}});var n,i=((n=i||{}).CHANGE_FLYING_PLUGIN_CONFIG="CHANGE_FLYING_PLUGIN_CONFIG",n)},868685:function(e,t,r){r.d(t,{e:function(){return c}});var n=r("369239");r("514312"),r("561999"),r("121621"),r("904644"),r("953722"),r("724356"),r("947478"),r("864614"),r("616414"),r("224382"),r("74370"),r("533431"),r("917128"),r("621120"),r("890568"),r("494319"),r("631666"),r("542074"),r("783858"),r("677046"),r("540865"),r("794349"),r("612222");var i=r("544977"),o=r("698974"),a=r("171569"),s=(0,n.qH)(function e(t,r,i,o){var a=this;(0,n.PA)(this,e),this.config=e.getDefaultConfig(),Object.keys(o).map(function(e){void 0!==o[e]&&null!==o[e]&&(a.config[e]=o[e])}),this.duration=i,this.player=t,this.updateBitrate(r),this.curPCDNInBuffer=this.config.maxPCDNInBuffer,this.curPCDNOutBuffer=this.config.maxPCDNOutBuffer,this.PCDNChangeCnt=0},[{key:"updateBitrate",value:function(e){this.bitrate=e,!this.bitrate&&(this.bitrate=this.config.minBandwidth)}},{key:"getPCDNInBuffer",value:function(){var e=this.config,t=this.player,r=this.bitrate;if(!e.PCDNBufferControl)return null;var n=e.estPlayTime,i=n;e.estPTcontrol&&(i=Math.min(n,Math.max(0,this.duration-((null==t?void 0:t.currentTime)||0))));var o=e.safePCDNInFactor,a=e.minBandwidth,s=e.maxPCDNInBuffer,u=e.minPCDNInBuffer,c=o*Math.max((null==t?void 0:t.avgSpeedPCDN)*1024||0,a),l=r>0?(1-c/r)*i:0;return this.curPCDNInBuffer=Math.min(s,Math.max(u,l)),this.curPCDNInBuffer}},{key:"getPCDNOutBuffer",value:function(){var e=this.config,t=this.player,r=this.bitrate;if(!e.PCDNBufferControl)return null;var n=e.estPlayTime,i=n;e.estPTcontrol&&(i=Math.min(n,Math.max(0,this.duration-((null==t?void 0:t.currentTime)||0))));var o=e.safePCDNOutFactor,a=e.minBandwidth,s=e.maxPCDNOutBuffer,u=e.minPCDNOutBuffer,c=o*Math.max((null==t?void 0:t.avgSpeedPCDN)*1024||0,a),l=r>0?(1-c/r)*i:0;return this.curPCDNOutBuffer=Math.min(s,Math.max(u,l)),this.curPCDNOutBuffer}},{key:"getPCDNChangeCnt",value:function(){var e=this.config,t=e.PCDNCntControl,r=e.alpha,n=this.curPCDNInBuffer,i=this.player,o=(null==i?void 0:i.bufferedPoint)||null,a=o&&o.end?o.end-i.currentTime:0;return t?a>n+(this.PCDNChangeCnt-1)*r&&this.PCDNChangeCnt++:a>=n&&this.PCDNChangeCnt<2&&this.PCDNChangeCnt++,this.PCDNChangeCnt}}],[{key:"getDefaultConfig",value:function(){return{PCDNBufferControl:!1,PCDNCntControl:!1,estPTcontrol:!1,minPCDNInBuffer:8,maxPCDNInBuffer:12,minPCDNOutBuffer:3,maxPCDNOutBuffer:6,safePCDNInFactor:.1,safePCDNOutFactor:.4,alpha:.5,estPlayTime:12,minBandwidth:1e6}}}]),u=new Map,c=function(){var e,t;function r(e,t,o,a){var u,c=this;(0,n.PA)(this,r),this.options=r.getDefaultConfig(),Object.keys(e).map(function(t){void 0!==e[t]&&null!==e[t]&&(c.options[t]=e[t])}),!this.options.productConfig||this.options.productConfig.app_id,this.loader=new i.mf(this.options),this.resetTrackeArgs(),this._lastFileInfo=null,this.lastfetchNodeTime=-1,this._lastRetFileKey=null,this._minUpdateNodeStep=this.options.ErrorTimeStep,null!==(u=this.options)&&void 0!==u&&null!==(u=u.adaptPCDNConfig)&&void 0!==u&&u.PCDNBufferControl&&(this.pcdnAdapt=new s(t,o,a,this.options.adaptPCDNConfig))}return(0,n.qH)(r,[{key:"isOpenAdaptPCDN",get:function(){return!!this.pcdnAdapt}},{key:"curPCDNInBuffer",get:function(){return this.pcdnAdapt.curPCDNInBuffer}},{key:"getPCDNInBuffer",value:function(){var e;return null===(e=this.pcdnAdapt)||void 0===e?void 0:e.getPCDNInBuffer()}},{key:"curPCDNOutBuffer",get:function(){return this.pcdnAdapt.curPCDNOutBuffer}},{key:"getPCDNOutBuffer",value:function(){var e;return null===(e=this.pcdnAdapt)||void 0===e?void 0:e.getPCDNOutBuffer()}},{key:"curPCDNChangeCnt",get:function(){return this.pcdnAdapt.PCDNChangeCnt}},{key:"getPCDNChangeCnt",value:function(){var e;return null===(e=this.pcdnAdapt)||void 0===e?void 0:e.getPCDNChangeCnt()}},{key:"updatePCDNBitrate",value:function(e){var t;return null===(t=this.pcdnAdapt)||void 0===t?void 0:t.updateBitrate(e)}},{key:"resetTrackeArgs",value:function(e){this.trackeArgs={fid:null,trace_id:null,req_times:(null==e?void 0:e.req_times)||0,resp_times:(null==e?void 0:e.resp_times)||0,token:null,node_num:this.options.node_num,client_info:this.options.client_info}}},{key:"getPCDNNode",value:function(e,t,r){var n,i=h(t),a=u.get(l(e,i)),s=new o.Q;return!(null!=a&&a.nodes)||(null==a||null===(n=a.nodes)||void 0===n?void 0:n.length)<1?this.fetchPCDNNode(null,null,r).then(function(e){s.resolve(e)}).catch(function(e){s.reject(e)}):(a.fromCache=!0,s.resolve(a)),s}},{key:"removePCDNNode",value:function(e,t,r){var n=h(t),i=u.get(l(e,n)),o=null==i?void 0:i.nodes;o&&(r?i.nodes=o.filter(function(e){return e&&0>r.indexOf(e.url)}):o.shift(),u.set(l(e,n),i)),(!o||!o.length)&&this.fetchPCDNNode().then().catch(function(){})}},{key:"fetchPCDNNode",value:(e=(0,n.x)((0,n.l5)().mark(function e(t,a,s){var c,d,f,v,p,g,_,m,y,b,k,E,C,w,x,L;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=new o.Q,a){e.next=5;break}a=this._lastFileInfo,e.next=15;break;case 5:if(a.byterate=h(a.bitrate),this.options.trackerOptions&&Object.assign(a,this.options.trackerOptions),this._lastFileInfo=Object.assign({},a,{byterate:a.byterate}),!((null==(f=u.get(l(a.vid,a.byterate)))||null===(d=f.nodes)||void 0===d?void 0:d.length)>0)){e.next=13;break}return f.fromCache=!0,c.resolve(f),e.abrupt("return",c);case 13:delete a.bitrate,this._lastFileInfo=a;case 15:if(a){e.next=18;break}return c.resolve(null),e.abrupt("return",c);case 18:if(v=!1,p=l(a.vid,a.byterate),this._lastRetFileKey!==p&&(this.resetTrackeArgs(),v=!0),!(Date.now()-this.lastfetchNodeTime<this._minUpdateNodeStep&&!v)){e.next=24;break}return c.resolve(null),e.abrupt("return",c);case 24:if(this.lastfetchNodeTime=Date.now(),this._lastRetFileKey=p,a.sfid?a.version=1:a.vid&&(a.version=2),this.options.withReferer&&(a.with_referer=this.options.withReferer),g=JSON.stringify(Object.assign(this.options.productConfig,{file_info:a},this.trackeArgs,{req_id:s})),!(this.trackeArgs.req_times>=this.options.maxCnt)){e.next=33;break}return c.resolve(null),e.abrupt("return",c);case 33:return!this.loader&&(this.loader=new i.mf(this.options)),this.trackeArgs.req_times+=1,e.prev=35,r.pcdn_tracker_request_cnt++,e.next=39,this.loader.load(t||this.options.trackerUrl,{body:g});case 39:_=e.sent,m=null,_&&(this.trackeArgs.resp_times+=1,b=8*a.byterate,_.done&&null!==(y=_.data)&&void 0!==y&&y.Result?((m=(k=_.data.Result).nodes)&&m.length>0?r.pcdn_tracker_success_cnt++:this._minUpdateNodeStep=this.options.NULLNodeTimeStep,m.map(function(e){e.vid=a.vid,e.bitrate=b}),E=k.fid,C=k.trace_id,w=k.req_id,x={nodes:m,fid:E,vid:a.vid,trace_id:C,req_id:w,bitrate:b},L=l(a.vid,a.byterate),u.set(L,x),this.trackeArgs.fid=k.fid,this.trackeArgs.trace_id=k.trace_id,this.trackeArgs.token=k.token,c.resolve(x)):(this._minUpdateNodeStep=this.options.ErrorTimeStep,c.reject(_))),e.next=49;break;case 44:e.prev=44,e.t0=e.catch(35),this._minUpdateNodeStep=this.options.ErrorTimeStep,c.reject(e.t0);case 49:return e.abrupt("return",c);case 50:case"end":return e.stop()}},e,this,[[35,44]])})),function(t,r,n){return e.apply(this,arguments)})}],[{key:"pluginName",get:function(){return"PCDN"}},{key:"pcdnReqCnt",get:function(){var e=r.pcdn_tracker_request_cnt,t=r.pcdn_tracker_success_cnt;return r.pcdn_tracker_request_cnt=0,r.pcdn_tracker_success_cnt=0,{pcdn_tracker_request_cnt:e,pcdn_tracker_failed_cnt:e-t}}},{key:"getDefaultConfig",value:function(){return{trackerUrl:"",loaderType:a.t.FETCH,responseType:a.U.JSON,mode:"cors",method:"POST",retry:0,retryDelay:3e3,timeout:5e3,node_num:5,client_info:null,maxCnt:30,withReferer:0,NULLNodeTimeStep:6e4,ErrorTimeStep:15e3}}},{key:"gainPCDNNode",value:(t=(0,n.x)((0,n.l5)().mark(function e(t,a,s,u){var c,l,d,f,v,p;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.getDefaultConfig(),Object.keys(a).map(function(e){void 0!==a[e]&&null!==a[e]&&(c[e]=a[e])}),!u||u.app_id,l=new o.Q,s?(s.byterate=h(s.bitrate),this.options.trackerOptions&&Object.assign(s,this.options.trackerOptions),delete s.bitrate):l.reject("video fileInfo need set"),d=JSON.stringify(Object.assign(u,{file_info:s},{node_num:(null==a?void 0:a.node_num)||3})),f=new i.mf(c),e.prev=8,r.pcdn_tracker_request_cnt++,e.next=12,f.load(t,{body:d});case 12:(p=e.sent).done&&(null===(v=p.data)||void 0===v||null===(v=v.Result)||void 0===v||null===(v=v.nodes)||void 0===v?void 0:v.length)>0&&r.pcdn_tracker_success_cnt++,l.resolve(p),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(8),l.reject((null===e.t0||void 0===e.t0?void 0:e.t0.message)||"get pcdnNode error");case 20:return e.abrupt("return",l);case 21:case"end":return e.stop()}},e,this,[[8,17]])})),function(e,r,n,i){return t.apply(this,arguments)})}])}();function l(e,t){return"".concat(e,"-").concat(t)}function h(e){return Math.floor(e/8)}(0,n._x)(c,"pcdn_tracker_request_cnt",0),(0,n._x)(c,"pcdn_tracker_success_cnt",0)},6214:function(e,t,r){function n(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n.key),n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}r.d(t,{PA:function(){return n},qH:function(){return o}})},922551:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(247425),i=r(938156);r(514312),r(561999),r(969642),r(379493);var o=r(495728),a=function(){function e(t){(0,n.Z)(this,e),this.TAG="AudioTimeRange",this._parent=t,this._buffers=[],this._duration=0,this._baseDts=0,this._lastBuffer=null}return(0,i.Z)(e,[{key:"isLive",get:function(){return this._parent.isLive}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"buffered",get:function(){var e=this;if(this.isLive)return{length:this._duration?1:0,start:function(){return 0},end:function(){return e._duration}};var t=this._mergeBufferRanges();return{length:t.length,start:function(e){var r=t[e];return r?r.start:0},end:function(e){var r=t[e];return r?r.end:1/0}}}},{key:"resetDts",value:function(e){this._baseDts=e}},{key:"_transitionSamples",value:function(e){for(var t=e.numberOfChannels,r=e.length,n=0;n<t;n++){for(var i=e.getChannelData(n),o=0;o<512;o++)i[o]=i[o]*o/512;for(var a=r-512;a<r;a++)i[a]=i[a]*(r-a)/512}}},{key:"append",value:function(e,t,r,n){-1===this._baseDts&&(this._baseDts=r),this._transitionSamples(e);var i=(r-this._baseDts)/1e3,a=i+t,s={start:i,end:a,startDts:r,source:e,duration:t,delay:n};return(o.kg.log(this.TAG,"add new buffer range, startDts:".concat(r,", [").concat(s.start," , ").concat(s.end,"]")),this._buffers.filter(function(e){return e.start===i}).length)?void 0:(this._buffers.push(s),this.isLive&&(this._duration=a),s.start)}},{key:"deletePassed",value:function(e){return this._buffers=this._buffers.filter(function(t){return t.start>=e}),this._buffers[0]}},{key:"canSeek",value:function(e){var t=this._buffers[this._buffers.length-1];return!!t&&!(t.start<e)&&!0}},{key:"_mergeBufferRanges",value:function(){var e=this._buffers.slice().sort(function(e,t){return e.start>t.start?1:-1}),t=e.length,r=[];if(!t)return r;for(var n={start:e[0].start,end:e[0].end},i=1;i<t;i++){var o=e[i];.5>Math.abs(n.end-o.start)?n.end=o.end:(r.push(n),n={start:o.start,end:o.end})}return r.push(n),r}},{key:"getBuffer",value:function(e){if(this.isLive)return this._buffers.shift();var t=this._buffers.filter(function(t){return t.start<e+.5&&t.end>e+.5})[0];return(o.kg.log(this.TAG,"get audio buffer , currentTime:".concat(e," ,buffer:[").concat(t&&t.start," , ").concat(t&&t.end,"]")),0!==e||t)?t:this._buffers[0]}},{key:"hasBuffer",value:function(){var e;return!!(null!==(e=this._buffers)&&void 0!==e&&e.length)}}]),e}()},154440:function(e,t,r){r.d(t,{Z:function(){return m}}),r(530129);var n=r(247425),i=r(938156),o=r(440669),a=r(356670),s=r(269277),u=r(917970),c=r(197201),l=r(668117);r(514312),r(724356);var h=r(495728),d=r(602837),f=r(17982),v=r(198114),p=r(467538),g=r(364508),_=r(720202),m=function(e){(0,s.Z)(m,e);var t,r,d=(t=m,r=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=(0,c.Z)(t);return e=r?Reflect.construct(n,arguments,(0,c.Z)(this).constructor):n.apply(this,arguments),(0,u.Z)(this,e)});function m(){var e;(0,n.Z)(this,m);for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=d.call.apply(d,[this].concat(r)),(0,l.Z)((0,o.Z)(e),"TAG","VideoRenderWithDecoder"),(0,l.Z)((0,o.Z)(e),"_hideRenderFlag",0),(0,l.Z)((0,o.Z)(e),"_recentMeta",null),(0,l.Z)((0,o.Z)(e),"_inChaseFrame",!1),(0,l.Z)((0,o.Z)(e),"_decoderErrorCallback",function(t){e._emitError(t,1)}),(0,l.Z)((0,o.Z)(e),"_decoderMessageCallback",function(t){var r,n,i,a=t.type,s=t.data;switch(a){case"DECODER_READY":e.analyse.addWasmReady(),e._startDecode();break;case"RECEIVE_FRAME":if(e._inChaseFrame&&!(null!==(r=e._decodeController)&&void 0!==r&&r.webcodec))return;e._receiveFrame(s);break;case"BATCH_FINISH":null===(n=(0,o.Z)(e))||void 0===n||n._decodeEstimate.resetDecodeDot(),e._inChaseFrame&&(e._inChaseFrame=!1,e._frameQueue.empty()),!e._ready&&!e.inSeeking&&null!==(i=e._decodeController)&&void 0!==i&&i.decoderReady&&e._startDecode()}}),e}return(0,i.Z)(m,[{key:"wasmInitCost",get:function(){var e;return null===(e=this._decodeController)||void 0===e?void 0:e.wasmInitCost}},{key:"hevcThread",get:function(){return 1===this.decodeMode}},{key:"lowlatency",get:function(){return this._parent.lowlatency}},{key:"nextFrameTime",get:function(){var e=this._frameQueue.nextFrame();return(e&&e.info&&e.info.dts||0)/1e3}},{key:"offscreenUsed",get:function(){return(0,g.tT)().offscreenCanvas}},{key:"ajustSeekTime",value:function(e,t){var r;h.kg.warn(this.TAG,"ajust seek time[preciseSeek:".concat(!!t,"]: "),e),this._frameQueue.empty(),null===(r=this._decodeController)||void 0===r||r.flushDecoder(),this._switchVideoBuffer(e,t)}},{key:"canSeek",value:function(){return!0}},{key:"_appendChunk",value:function(e){if(!this.noVideo&&!!this._timeRange){if(this._meta){if(this._recentMeta.width!==e.width||this._recentMeta.height!==e.height){h.kg.warn(this.TAG,"metadata changed! width: ".concat(this._recentMeta.width," -> ").concat(e.width,", height: ").concat(this._recentMeta.height," -> ").concat(e.height));var t=e.samples[0];t&&(this._recentMeta=t.meta=Object.assign({},e,{samples:null}))}}else{this._emitTimelineEvents(_.ZP.TIMELINE.PLAY_EVENT,_.ZP.VIDEO_EVENTS.LOADEDMETADATA),this._recentMeta=this._meta=Object.assign({},e,{samples:null}),h.kg.warn(this.TAG,"video set metadata",this._meta,"configuration:",this.configuration);var r,n,i=e.fpsNum/e.fpsDen;i?h.kg.log(this.TAG,"detect fps:",i):h.kg.warn(this.TAG,"no detect fps,start estimate"),this._selectDecoder(),this._initDecoder(),this._initFrameRender()}this._timeRange.append(e.samples,this._isLive&&this.noAudio,!this.videoDecode),e.samples=[],!this.inSeeking&&(!this.isLive&&!this._timeRange.frameLength&&this._switchVideoBuffer(this._parent.currentTime),!this._ready&&null!==(r=this._decodeController)&&void 0!==r&&r.decoderReady&&(this.noAudio||!(null!==(n=this._decodeController)&&void 0!==n&&n.inDecoding))&&this._startDecode(),this.noAudio&&this._emitTimelineEvents(_.ZP.TIMELINE.PLAY_EVENT,_.ZP.VIDEO_EVENTS.DURATION_CHANGE))}}},{key:"_selectDecoder",value:function(){if(!this.isHevc&&f.Z.isSupported()){this._decodeController=new f.Z(this),this._decodeEstimate.webcodec=!0;return}this._decodeController=new v.Z(this)}},{key:"_initDecoder",value:function(){var e;null===(e=this._decodeController)||void 0===e||e.init(this._decoderMessageCallback,this._decoderErrorCallback)}},{key:"_initFrameRender",value:function(){try{if(this.offscreenUsed){this._renderWorker.initRenderContext({meta:this._meta,type:this._decodeController.webcodec?"2d":""}),this._frameRender=function(){};return}var e=Object.assign(this._config,{meta:this._meta,canvas:this._canvas,type:this._decodeController.webcodec?"2d":""});this._frameRender=new p.S(e,this),h.kg.log(this.TAG,"create frameRender with config",e)}catch(e){this._emitError(e&&e.message,2)}}},{key:"_startDecode",value:function(){var e;null===(e=this._decodeController)||void 0===e||e.doDecode()}},{key:"_switchVideoBuffer",value:function(e,t){var r,n=this._timeRange.switchBuffer(e);if(n){if(this.noAudio&&this._parent.emit(_.ZP.TIMELINE.SYNC_DTS,this.getDtsOfTime(n.start)),t){null===(r=this._decodeController)||void 0===r||r.preciseSeek(e);return}this._startDecode(t)}}},{key:"_checkToDecode",value:function(){var e;!this.inSeeking&&(null===(e=this._decodeController)||void 0===e||e.checkToDecode(this._frameQueue.length))}},{key:"_render",value:function(e){if(!this.noVideo){var t,r,n,i=this._frameQueue&&this._frameQueue.nextFrame();if(!i){if(h.kg.log(this.TAG,"lack frame, ","inDecoding:",null===(r=this._decodeController)||void 0===r?void 0:r.inDecoding),this._checkToDecode(),this.noAudio){if(!this.isLive&&.5>Math.abs(this.currentTime-this.duration)){this===null||void 0===this||this._emitTimelineEvents(_.ZP.TIMELINE.PLAY_EVENT,_.ZP.VIDEO_EVENTS.TIMEUPDATE),this===null||void 0===this||this._emitTimelineEvents(_.ZP.TIMELINE.PLAY_EVENT,_.ZP.VIDEO_EVENTS.ENDED),null===(n=this._timeRange)||void 0===n||n.clean();return}!this._timeRange.frameLength&&(this._ready=!1,this.emit(_.ZP.VIDEO.VIDEO_WAITING))}return}var o=i.info;if(!o){this._frameQueue.shift();return}this._renderDts=o.dts;var a=o.dts-this.preciseVideoDts;if(!!e||!(a>0)||!(a<6e4)){this._frameQueue.shift(this.preciseVideoDts),Math.abs(this._lastTimeupdate-o.dts)>250&&(this._emitTimelineEvents(_.ZP.TIMELINE.PLAY_EVENT,_.ZP.VIDEO_EVENTS.TIMEUPDATE,{pts:o.originPts/90}),this._lastTimeupdate=o.dts),h.kg.long&&h.kg.log(this.TAG,"render delay:".concat(a," , timelinePosition:").concat(this.preciseVideoDts," , dts:").concat(o.dts," , cost:").concat(o.cost," , gopID:").concat(o.gopId," , rest:").concat(this._frameQueue.length,", buffer frame:").concat(this._timeRange.frameLength));var s=performance.now();this._hideRenderFlag++,"visible"===document.visibilityState?this.offscreenUsed?this._renderWorker.render(i.buffer,i.width,i.height,i.yLinesize,i.uvLinesize):this._frameRender.render(i.buffer,i.width,i.height,i.yLinesize,i.uvLinesize):this._hideRenderFlag%15&&(this.offscreenUsed?this._renderWorker.render(i.buffer,i.width,i.height,i.yLinesize,i.uvLinesize):this._frameRender.render(i.buffer,i.width,i.height,i.yLinesize,i.uvLinesize)),null!==(t=this._decodeController)&&void 0!==t&&t.webcodec&&i.buffer.close(),this._renderCost=performance.now()-s,this._checkToDecode()}}}},{key:"_updateSegmentEnd",value:function(e){var t;null===(t=this._timeRange)||void 0===t||t.updateSegmentEnd(e)}},{key:"_doChaseFrame",value:function(e){var t=e.frame;this._inChaseFrame=!0,this._timeRange.deletePassed(t.dts),this._frameQueue.empty(),this.noAudio&&this._parent.emit(_.ZP.TIMELINE.SYNC_DTS,t.dts)}},{key:"_destroy",value:function(e){var t;h.kg.log(this.TAG,"destroy video render"),(0,a.Z)((0,c.Z)(m.prototype),"destroy",this).call(this,e),null===(t=this._decodeController)||void 0===t||t.destroy(),this._decodeController=null}}]),m}(d.Z)},981500:function(e,t,r){r.d(t,{Kd:function(){return p},Lc:function(){return g},PA:function(){return u},WY:function(){return _},XW:function(){return d},ZQ:function(){return m},Zj:function(){return i},_x:function(){return h},l5:function(){return o},qH:function(){return l},u:function(){return y},x:function(){return s}});function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){h(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(){o=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,i){var o=Object.create((t&&t.prototype instanceof f?t:f).prototype);return n(o,"_invoke",{value:function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return L()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+n+"' method")),d;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,d;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,d):a:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,d)}(a,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,new w(i||[]))}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function f(){}function v(){}function p(){}var g={};c(g,a,function(){return this});var _=Object.getPrototypeOf,m=_&&_(_(x([])));m&&m!==t&&r.call(m,a)&&(g=m);var y=p.prototype=f.prototype=Object.create(g);function b(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function k(e,t){var i;n(this,"_invoke",{value:function(n,o){function a(){return new t(function(i,a){!function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then(function(e){n("next",e,a,s)},function(e){n("throw",e,a,s)}):t.resolve(l).then(function(e){c.value=e,a(c)},function(e){return n("throw",e,a,s)})}s(u.arg)}(n,o,i,a)})}return i=i?i.then(a,a):a()}})}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:L}}function L(){return{value:void 0,done:!0}}return v.prototype=p,n(y,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:v,configurable:!0}),v.displayName=c(p,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,u,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(k.prototype),c(k.prototype,s,function(){return this}),e.AsyncIterator=k,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new k(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},b(y),c(y,u,"Generator"),c(y,a,function(){return this}),c(y,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function a(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){r(e);return}s.done?t(u):Promise.resolve(u).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)})}}function u(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++){if(r=o[n],!(t.indexOf(r)>=0))Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}}return i}function g(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);return r=t?Reflect.construct(n,arguments,f(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return g(e)}(this,r)}}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||b(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function E(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}},912913:function(e,t,r){r.d(t,{i:function(){return l}});var n=r(15810),i=r(106989),o=r(886117),a=r(171569),s=r(698974),u=r(46101),c=["retry","retryDelay","onRetryError","transformError"],l=function(){var e;function t(e,r){(0,n.PA)(this,t),this.promise=(0,s.Q)(),this.alive=!!r.onProgress,r.logger||(r.logger=new u.Y("Loader")),this._loaderType=e,this._loader=e===a.t.FETCH&&"undefined"!=typeof fetch?new i.j:new o.c,this._config=r,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=r.retryCheckFunc,this._logger=r.logger}return(0,n.qH)(t,[{key:"exec",value:function(){var e,t=this,r=this._config,i=r.retry,o=r.retryDelay,a=r.onRetryError,s=r.transformError,u=(0,n.Kd)(r,c);var l=(e=(0,n.x)((0,n.l5)().mark(function e(){var r,c,h;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t._loader.load(u);case 3:r=e.sent,t.promise.resolve(r),e.next=27;break;case 7:if(e.prev=7,e.t0=e.catch(0),t._loader.running=!1,t._logger.debug("[task request catch err]",e.t0),!t._canceled){e.next=13;break}return e.abrupt("return");case 13:if(e.t0.loaderType=t._loaderType,e.t0.retryCount=t._retryCount,c=e.t0,s&&(c=s(c)||c),a&&t._retryCount>0&&a(c,t._retryCount,{index:u.index,vid:u.vid,range:u.range,priOptions:u.priOptions}),t._retryCount++,h=!0,t._retryCheckFunc&&(h=t._retryCheckFunc(e.t0)),!(h&&t._retryCount<=i)){e.next=26;break}return clearTimeout(t._retryTimer),t._logger.debug("[task request setTimeout],retry",t._retryCount,",retry range,",u.range),t._retryTimer=setTimeout(l,o),e.abrupt("return");case 26:t.promise.reject(c);case 27:case"end":return e.stop()}},e,null,[[0,7]])})),function(){return e.apply(this,arguments)});return l(),this.promise}},{key:"cancel",value:(e=(0,n.x)((0,n.l5)().mark(function e(){return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,e.abrupt("return",this._loader.cancel());case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),t}()},365753:function(e,t,r){r.d(t,{l:function(){return i}});var n=r(932393),i=function(){function e(){(0,n.PA)(this,e)}return(0,n.qH)(e,null,[{key:"start",value:function(e){return!e||!e.length||1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&0>e.start(0)?0:e.start(0)}},{key:"end",value:function(e){return!e||!e.length||1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1)}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(e){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,i=e.length;n<i;n++){var o=r.length;if(o&&t){var a=r[o-1],s=a[1];if(e.start(n)-s<=t){var u=e.end(n);u>s&&(a[1]=u)}else r.push([e.start(n),e.end(n)])}else r.push([e.start(n),e.end(n)])}return r}},{key:"totalLength",value:function(e){return e&&e.length?e.reduce(function(e,t){return e+(t[1]-t[0])},0):0}},{key:"info",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var i=0,o=0,a=0,s=0,u=0,c=0,l=0,h=e.buffers(t,n),d=0,f=h.length;d<f;d++){var v=h[d];if(r+n>=v[0]&&r<=v[1])i=v[0],o=v[1],a=d;else if(r+n<v[0]){s=v[0],u=v[1];break}else r+n>v[1]&&(c=v[0],l=v[1])}return{start:i,end:o,index:a,buffers:h,nextStart:s,nextEnd:u,prevStart:c,prevEnd:l,currentTime:r,behind:r-i,remaining:o?o-r:0,length:e.totalLength&&e.totalLength(h)}}}]),e}()},897948:function(e,t,r){r.d(t,{Fc:function(){return s},WE:function(){return a},wb:function(){return o}});var n,i=r(932393),o={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",MSE_CHANGE_TYPE:"MSE_CHANGE_TYPE",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITING_TIMEOUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},a=(n={},(0,i._x)(n,o.MANIFEST,{HLS:1100,DASH:1200}),(0,i._x)(n,o.NETWORK,2100),(0,i._x)(n,o.NETWORK_TIMEOUT,2101),(0,i._x)(n,o.NETWORK_FORBIDDEN,2103),(0,i._x)(n,o.NETWORK_NOTFOUND,2104),(0,i._x)(n,o.NETWROK_RANGE_NOT_SATISFIABLE,2116),(0,i._x)(n,o.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),(0,i._x)(n,o.REMUX,{FMP4:4100,MP4:4200}),(0,i._x)(n,o.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,MSE_CHANGE_TYPE:5205,EME_HIJACK:5301}),(0,i._x)(n,o.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),(0,i._x)(n,o.OTHER,8e3),(0,i._x)(n,o.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003}),n),s=function(e){(0,i.XW)(r,e);var t=(0,i.WY)(r);function r(e,n,s,u,c){var l;return(0,i.PA)(this,r),(l=t.call(this,c||(null==s?void 0:s.message))).errorType=e===o.NETWORK_TIMEOUT?o.NETWORK:e,l.originError=s,l.ext=u,l.errorCode=a[e][n]||a[e],l.errorMessage=l.message,!l.errorCode&&(l.errorType=o.OTHER,l.errorCode=a[l.errorType]),l}return(0,i.qH)(r,null,[{key:"create",value:function(e,t,n,i,a){return e instanceof r?e:(e instanceof Error&&(n=e,e=""),!e&&(e=o.OTHER),new r(e,t,n,i,a))}},{key:"network",value:function(e){var t;return new r(null!=e&&e.isTimeout?o.NETWORK_TIMEOUT:o.NETWORK,null,e instanceof Error?e:null,{url:null==e?void 0:e.url,response:null==e?void 0:e.response,httpCode:null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.status})}}]),r}((0,i.wm)(Error))},114191:function(e,t,r){r.d(t,{N:function(){return s}});var n=r(247425),i=r(938156);r(227470),r(410121),r(864614),r(210434),r(121621),r(812735),r(623302),r(983431),r(319386),r(657170),r(853127),r(644952),r(759149),r(949136),r(966922),r(33814),r(29536),r(716005),r(548485),r(260075),r(791017),r(743286),r(310378),r(124539),r(48498),r(728271),r(814647),r(535689),r(659673);var o=r(244542),a=r(115869),s=function(){function e(t,r){(0,n.Z)(this,e),this.videoTrack=t,this.audioTrack=r;var i=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=i&&50>Number(i[1])}return(0,i.Z)(e,[{key:"remux",value:function(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.videoTrack,s=this.audioTrack,u=a.exist(),c=s.exist();return i&&(u&&(e=o.b.initSegment([this.videoTrack])),c&&(t=o.b.initSegment([this.audioTrack]))),u&&a.hasSample()&&(r=this._remuxVideo()),c&&s.hasSample()&&(n=this._remuxAudio()),a.samples=[],s.samples=[],{videoInitSegment:e,audioInitSegment:t,videoSegment:r,audioSegment:n}}},{key:"_remuxVideo",value:function(){var e=this.videoTrack,t=e.samples;this.forceFirstIDR&&(t[0].flag={dependsOn:2,isNonSyncSample:0});var r=0;t.forEach(function(e){r+=e.units.reduce(function(e,t){return e+t.byteLength},0)+4*e.units.length});for(var n=new Uint8Array(r),i=new DataView(n.buffer),s=function(e,r,o,a){a=t[e];var s=0;a.units.forEach(function(e){i.setUint32(o,e.byteLength),o+=4,n.set(e,o),o+=e.byteLength,s+=4+e.byteLength}),a.size=s,h=o,u=a},u,c=0,l=t.length,h=0;c<l;c++)s(c,l,h,u);var d=o.b.moof(this.videoTrack.sequenceNumber++,[e]),f=o.b.mdat(n);return(0,a.gJ)(d,f)}},{key:"_remuxAudio",value:function(){var e=this.audioTrack,t=o.b.moof(this.audioTrack.sequenceNumber++,[e]),r=new Uint8Array(e.samples.reduce(function(e,t){return e+t.size},0));e.samples.reduce(function(e,t){return r.set(t.data,e),e+t.size},0);var n=o.b.mdat(r);return(0,a.gJ)(t,n)}}]),e}()},757714:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(75161),i=function(){function e(t){if((0,n.PA)(this,e),(0,n._x)(this,"_bytesAvailable",void 0),(0,n._x)(this,"_bitsAvailable",0),(0,n._x)(this,"_word",0),!t)throw Error("ExpGolomb data params is required");this._data=t,this._bytesAvailable=t.byteLength,this._bytesAvailable&&this._loadWord()}return(0,n.qH)(e,[{key:"_loadWord",value:function(){var e=this._data.byteLength-this._bytesAvailable,t=Math.min(4,this._bytesAvailable);if(0===t)throw Error("No bytes available");var r=new Uint8Array(4);r.set(this._data.subarray(e,e+t)),this._word=new DataView(r.buffer).getUint32(0),this._bitsAvailable=8*t,this._bytesAvailable-=t}},{key:"bitsPos",value:function(){return 8*this._bytesAvailable-this._bitsAvailable}},{key:"bitsLeft",value:function(){return 8*this._data.length-this.bitsPos()}},{key:"byteAligned",value:function(){return 0===this.bitsPos()||this.bitsPos()%8==0}},{key:"skipBits",value:function(e){if(this._bitsAvailable>e)this._word<<=e,this._bitsAvailable-=e;else{var t=Math.floor((e-=this._bitsAvailable)/8);e-=8*t,this._bytesAvailable-=t,this._loadWord(),this._word<<=e,this._bitsAvailable-=e}}},{key:"readBits",value:function(e){if(e>32)throw Error("Cannot read more than 32 bits");var t=Math.min(this._bitsAvailable,e),r=this._word>>>32-t;return(this._bitsAvailable-=t,this._bitsAvailable>0?this._word<<=t:this._bytesAvailable>0&&this._loadWord(),(t=e-t)>0&&this._bitsAvailable)?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this._bitsAvailable;++e)if((this._word&2147483648>>>e)!=0)return this._word<<=e,this._bitsAvailable-=e,e;return this._loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBool",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"skipScalingList",value:function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r}}]),e}()},334884:function(e,t,r){r.d(t,{W:function(){return o}});var n=r(75161),i=r(237125),o=function(){function e(){(0,n.PA)(this,e),(0,n._x)(this,"id",2),(0,n._x)(this,"type",i.Vc.AUDIO),(0,n._x)(this,"codecType",i.yQ.AAC),(0,n._x)(this,"pid",-1),(0,n._x)(this,"codec",""),(0,n._x)(this,"sequenceNumber",0),(0,n._x)(this,"sampleDuration",0),(0,n._x)(this,"timescale",0),(0,n._x)(this,"formatTimescale",0),(0,n._x)(this,"baseMediaDecodeTime",0),(0,n._x)(this,"duration",0),(0,n._x)(this,"warnings",[]),(0,n._x)(this,"samples",[]),(0,n._x)(this,"baseDts",0),(0,n._x)(this,"sampleSize",16),(0,n._x)(this,"sampleRate",0),(0,n._x)(this,"channelCount",0),(0,n._x)(this,"objectType",0),(0,n._x)(this,"sampleRateIndex",0),(0,n._x)(this,"config",[]),(0,n._x)(this,"present",!1),(0,n._x)(this,"isVideoEncryption",!1),(0,n._x)(this,"isAudioEncryption",!1),(0,n._x)(this,"kid",null),(0,n._x)(this,"ext",void 0)}return(0,n.qH)(e,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===i.yQ.AAC)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}}]),e}()},405664:function(e,t,r){r.d(t,{Bh:function(){return o},_b:function(){return u},dB:function(){return c},e2:function(){return a},h9:function(){return s},i4:function(){return n},sV:function(){return i}});function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<8)+(e[t+1]||0)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<16)+(e[t+1]<<8)+(e[t+2]||0)}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+(e[t+3]||0)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 4294967296*o(e,t)+o(e,t+4)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getUint32(t)<<32|r.getUint32(t+4)}function c(e){for(var t,r="avc1.",n=0;n<3;n++)(t=e[n].toString(16)).length<2&&(t="0".concat(t)),r+=t;return r}}}]);